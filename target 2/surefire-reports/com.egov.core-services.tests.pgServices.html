<!DOCTYPE html>
<html lang="en">
  <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <link href="res/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="res/karate-report.css" rel="stylesheet" type="text/css">
    <link href="favicon.ico" rel="shortcut icon">
    <script src="res/jquery.min.js" type="text/javascript"></script>
    <script src="res/jquery.tablesorter.min.js" type="text/javascript"></script>
    <script src="res/bootstrap.min.js" type="text/javascript"></script>
    <script src="res/karate-report.js" type="text/javascript"></script>
    <title>com.egov.core-services.tests.pgServices</title>
  </head>
  <body>
    <div id="root-container">
      <div id="leftnav">
        <div class="nav-logo">
          <a href="karate-summary.html">
            <img alt="Karate" src="res/karate-logo.svg">
          </a>
          <div class="nav-count">
            <div class="bg-success" id="nav-pass">14</div>
            <div class="bg-danger" id="nav-fail">2</div>
          </div>
        </div>
        <div id="nav-type">Scenarios</div>         
        <div id="nav-date">2021-08-10 03:40:54 PM</div>        
      <div class="nav-container"><div class="nav-item passed"><a href="#[1:19]">[1:19] Verify creating a payment transaction </a></div><div class="nav-item passed"><a href="#[2:26]">[2:26] Verify creating a payment transaction with invalid/non existent or null value for "TxnAmt" in the request body and check for erros </a></div><div class="nav-item passed"><a href="#[3:34]">[3:34] Verify creating a payment transaction with invalid/non existent value for "tenatid" in the request body and check for errors </a></div><div class="nav-item passed"><a href="#[4:41]">[4:41] Verify creating a payment transaction with invalid/non existent value for "gateway" in the request body and check for errors </a></div><div class="nav-item passed"><a href="#[6:62]">[6:62] Verify creating a payment transaction by passing a txn amount which is not equal to the amount paid </a></div><div class="nav-item failed"><a href="#[7:70]">[7:70] Verify creating a payment transaction by passing a bill id which is expired </a></div><div class="nav-item passed"><a href="#[8:88]">[8:88] Verify creating a payment transaction by passing a amount which is greater than amount due </a></div><div class="nav-item passed"><a href="#[9:95]">[9:95] Verify creating a payment transaction with invalid/non existent value for "bill id" in the request body and check for errors </a></div><div class="nav-item passed"><a href="#[10:102]">[10:102] Verify creating a payment transaction with a bill id for which payment is already done </a></div><div class="nav-item passed"><a href="#[11:110]">[11:110] Update a payment transaction </a></div><div class="nav-item passed"><a href="#[12:116]">[12:116] Verify updating a payment transaction with invalid/non existent value for "transaction id" in the request body </a></div><div class="nav-item passed"><a href="#[13:123]">[13:123] Verify updating a payment transaction by not passing transaction id </a></div><div class="nav-item passed"><a href="#[14:129]">[14:129] Verify updating by passing a transaction id which has expired bill and bill which is already paid </a></div><div class="nav-item passed"><a href="#[15:136]">[15:136] Verify searching transaction details using txn id </a></div><div class="nav-item passed"><a href="#[16:142]">[16:142] Verify searching transaction details using null/ invalid/non existent  value for "transaction id" </a></div><div class="nav-item failed"><a href="#[17:151]">[17:151] Verfiy searching transaction details using multiple txn id's </a></div></div></div>
      <div id="content">
      <div class="page-heading alert alert-primary"><a href="karate-summary.html">Summary</a><span class="feature-label">|</span><a href="karate-tags.html">Tags</a><span class="feature-label">|</span><span class="feature-label">Feature:</span><span class="feature-name">com/egov/core-services/tests/pgServices.feature</span><span class="feature-description">Pg services</span></div><div class="scenario"><div class="scenario-heading" id="[1:19]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">positive</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a><a class="badge badge-primary" href="karate-tags.html">PGCreate_01</a></div><span class="scenario-keyword">Scenario: [1:19]</span><span class="scenario-name">Verify creating a payment transaction </span></div><div class="scenario-time passed">ms: 1107</div></div><div class="step-row"><div class="step-container" id="[1:19]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="1"><div class="step-ref bg-step">1</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">289</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="1.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">247</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="2"><div class="step-ref bg-step">2</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="preformatted" data-parent="2">15:40:33.045 karate.env:  
15:40:33.045 locale: en_IN 
15:40:33.045 tenantId: pb.amritsar</div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="3"><div class="step-ref bg-step">3</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="4"><div class="step-ref bg-step">4</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="5"><div class="step-ref bg-step">5</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="6"><div class="step-ref bg-step">6</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="7"><div class="step-ref bg-step">7</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="8"><div class="step-ref bg-step">8</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="9"><div class="step-ref bg-step">9</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="10"><div class="step-ref bg-step">10</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="11"><div class="step-ref bg-step">11</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="12"><div class="step-ref bg-step">12</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="13"><div class="step-ref bg-step">13</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="14"><div class="step-ref bg-step">14</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="15"><div class="step-ref bg-step">15</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="16"><div class="step-ref bg-step">16</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">216</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="16.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">208</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="17"><div class="step-ref bg-step">17</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="18"><div class="step-ref bg-step">18</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="19"><div class="step-ref bg-step">19</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="20"><div class="step-ref bg-step">20</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">13</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="21"><div class="step-ref bg-step">21</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="22"><div class="step-ref bg-step">22</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">12</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="23"><div class="step-ref bg-step">23</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="24"><div class="step-ref bg-step">24</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="25"><div class="step-ref bg-step">25</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="26"><div class="step-ref bg-step">26</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">170</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="27"><div class="step-ref bg-step">27</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="28"><div class="step-ref bg-step">28</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="29"><div class="step-ref bg-step">29</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="30"><div class="step-ref bg-step">30</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="30">15:40:33.322 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590233098,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763033101,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "2294d610-6986-4bf8-87de-b8b0ccea2915",
          "taxHeadMasterCode": "PT_FIRE_CESS",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590233515,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590233515
          },
          "tenantId": "pb.amritsar",
          "id": "d2e70f10-076d-4595-9a29-7f7ce2c69c37",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590233515,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590233515
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-592741",
      "id": "2294d610-6986-4bf8-87de-b8b0ccea2915",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="31"><div class="step-ref bg-step">31</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="32"><div class="step-ref bg-step">32</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="33"><div class="step-ref bg-step">33</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="34"><div class="step-ref bg-step">34</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="35"><div class="step-ref bg-step">35</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="36"><div class="step-ref bg-step">36</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="37"><div class="step-ref bg-step">37</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="38"><div class="step-ref bg-step">38</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="39"><div class="step-ref bg-step">39</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="40"><div class="step-ref bg-step">40</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="41"><div class="step-ref bg-step">41</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="42"><div class="step-ref bg-step">42</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="43"><div class="step-ref bg-step">43</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="44"><div class="step-ref bg-step">44</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="45"><div class="step-ref bg-step">45</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="46"><div class="step-ref bg-step">46</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="47"><div class="step-ref bg-step">47</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="48"><div class="step-ref bg-step">48</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="49"><div class="step-ref bg-step">49</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="50"><div class="step-ref bg-step">50</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">181</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="50.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">171</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="51"><div class="step-ref bg-step">51</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="52"><div class="step-ref bg-step">52</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="53"><div class="step-ref bg-step">53</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">5</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="54"><div class="step-ref bg-step">54</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="55"><div class="step-ref bg-step">55</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="56"><div class="step-ref bg-step">56</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="57"><div class="step-ref bg-step">57</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="58"><div class="step-ref bg-step">58</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="59"><div class="step-ref bg-step">59</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="60"><div class="step-ref bg-step">60</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">7</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="61"><div class="step-ref bg-step">61</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="62"><div class="step-ref bg-step">62</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="62">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="63"><div class="step-ref bg-step">63</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="64"><div class="step-ref bg-step">64</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="65"><div class="step-ref bg-step">65</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="66"><div class="step-ref bg-step">66</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">140</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="67"><div class="step-ref bg-step">67</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="68"><div class="step-ref bg-step">68</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="69"><div class="step-ref bg-step">69</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="70"><div class="step-ref bg-step">70</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="71"><div class="step-ref bg-step">71</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="72"><div class="step-ref bg-step">72</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="73"><div class="step-ref bg-step">73</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="74"><div class="step-ref bg-step">74</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="75"><div class="step-ref bg-step">75</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="76"><div class="step-ref bg-step">76</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="77"><div class="step-ref bg-step">77</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="78"><div class="step-ref bg-step">78</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="79"><div class="step-ref bg-step">79</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="80"><div class="step-ref bg-step">80</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="81"><div class="step-ref bg-step">81</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[1:19]bg"><div class="step-container" id="82"><div class="step-ref bg-step">82</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">7</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling create pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="83"><div class="step-ref passed">83</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionSuccessfully')</div></div><div class="time-cell passed">614</div></div><div class="step-row"><div class="step-container" id="83.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell passed">610</div></div><div class="step-row"><div class="step-container" id="84"><div class="step-ref passed">84</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="85"><div class="step-ref passed">85</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="86"><div class="step-ref passed">86</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="87"><div class="step-ref passed">87</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="88"><div class="step-ref passed">88</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="89"><div class="step-ref passed">89</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">607</div></div><div class="step-row"><div class="step-container" id="90"><div class="step-ref passed">90</div><div class="step-indent"> </div><div class="step-cell passed">Then status 200</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="91"><div class="step-ref passed">91</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="92"><div class="step-ref passed">92</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="93"><div class="step-ref passed">93</div><div class="step-indent"> </div><div class="step-cell passed">And def txnId = pgServicesCreateResponseBody.Transaction.txnId</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="94"><div class="step-ref passed">94</div><div class="step-cell passed">* match pgServicesCreateResponseBody == '#present'</div></div><div class="time-cell passed">1</div></div></div><div class="scenario"><div class="scenario-heading" id="[2:26]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">negative</a><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">PGCreate_InvalidTxnAmt_03</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a></div><span class="scenario-keyword">Scenario: [2:26]</span><span class="scenario-name">Verify creating a payment transaction with invalid/non existent or null value for "TxnAmt" in the request body and check for erros </span></div><div class="scenario-time passed">ms: 684</div></div><div class="step-row"><div class="step-container" id="[2:26]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="95"><div class="step-ref bg-step">95</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">257</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="95.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">229</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="96"><div class="step-ref bg-step">96</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="preformatted" data-parent="96">15:40:34.222 karate.env:  
15:40:34.222 locale: en_IN 
15:40:34.222 tenantId: pb.amritsar</div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="97"><div class="step-ref bg-step">97</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="98"><div class="step-ref bg-step">98</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="99"><div class="step-ref bg-step">99</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="100"><div class="step-ref bg-step">100</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="101"><div class="step-ref bg-step">101</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="102"><div class="step-ref bg-step">102</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="103"><div class="step-ref bg-step">103</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="104"><div class="step-ref bg-step">104</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="105"><div class="step-ref bg-step">105</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="106"><div class="step-ref bg-step">106</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="107"><div class="step-ref bg-step">107</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="108"><div class="step-ref bg-step">108</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="109"><div class="step-ref bg-step">109</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="110"><div class="step-ref bg-step">110</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">194</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="110.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">186</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="111"><div class="step-ref bg-step">111</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="112"><div class="step-ref bg-step">112</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="113"><div class="step-ref bg-step">113</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="114"><div class="step-ref bg-step">114</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">10</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="115"><div class="step-ref bg-step">115</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="116"><div class="step-ref bg-step">116</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">16</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="117"><div class="step-ref bg-step">117</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="118"><div class="step-ref bg-step">118</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="119"><div class="step-ref bg-step">119</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="120"><div class="step-ref bg-step">120</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">145</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="121"><div class="step-ref bg-step">121</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="122"><div class="step-ref bg-step">122</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="123"><div class="step-ref bg-step">123</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="124"><div class="step-ref bg-step">124</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="124">15:40:34.465 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590234267,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763034270,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "e4885add-e25d-470e-8a33-8d7de707ffad",
          "taxHeadMasterCode": "PT_TIME_REBATE",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590234665,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590234665
          },
          "tenantId": "pb.amritsar",
          "id": "f4b1d811-599c-4bbc-b7cf-96d98a3c82c4",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590234665,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590234665
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-790330",
      "id": "e4885add-e25d-470e-8a33-8d7de707ffad",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="125"><div class="step-ref bg-step">125</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="126"><div class="step-ref bg-step">126</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="127"><div class="step-ref bg-step">127</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="128"><div class="step-ref bg-step">128</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="129"><div class="step-ref bg-step">129</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="130"><div class="step-ref bg-step">130</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="131"><div class="step-ref bg-step">131</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="132"><div class="step-ref bg-step">132</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="133"><div class="step-ref bg-step">133</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="134"><div class="step-ref bg-step">134</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="135"><div class="step-ref bg-step">135</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="136"><div class="step-ref bg-step">136</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="137"><div class="step-ref bg-step">137</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="138"><div class="step-ref bg-step">138</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="139"><div class="step-ref bg-step">139</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="140"><div class="step-ref bg-step">140</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="141"><div class="step-ref bg-step">141</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="142"><div class="step-ref bg-step">142</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">5</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="143"><div class="step-ref bg-step">143</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="144"><div class="step-ref bg-step">144</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">180</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="144.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">167</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="145"><div class="step-ref bg-step">145</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="146"><div class="step-ref bg-step">146</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="147"><div class="step-ref bg-step">147</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="148"><div class="step-ref bg-step">148</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="149"><div class="step-ref bg-step">149</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="150"><div class="step-ref bg-step">150</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="151"><div class="step-ref bg-step">151</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="152"><div class="step-ref bg-step">152</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="153"><div class="step-ref bg-step">153</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="154"><div class="step-ref bg-step">154</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="155"><div class="step-ref bg-step">155</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="156"><div class="step-ref bg-step">156</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="156">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="157"><div class="step-ref bg-step">157</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="158"><div class="step-ref bg-step">158</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="159"><div class="step-ref bg-step">159</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="160"><div class="step-ref bg-step">160</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">138</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="161"><div class="step-ref bg-step">161</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="162"><div class="step-ref bg-step">162</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="163"><div class="step-ref bg-step">163</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="164"><div class="step-ref bg-step">164</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="165"><div class="step-ref bg-step">165</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="166"><div class="step-ref bg-step">166</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="167"><div class="step-ref bg-step">167</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="168"><div class="step-ref bg-step">168</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="169"><div class="step-ref bg-step">169</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="170"><div class="step-ref bg-step">170</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="171"><div class="step-ref bg-step">171</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">84</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="172"><div class="step-ref bg-step">172</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="173"><div class="step-ref bg-step">173</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="174"><div class="step-ref bg-step">174</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="175"><div class="step-ref bg-step">175</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[2:26]bg"><div class="step-container" id="176"><div class="step-ref bg-step">176</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">6</div></div><div class="step-row"><div class="step-container" id="177"><div class="step-ref passed">177</div><div class="step-cell passed">* def txnAmount = commonConstants.invalidParameters.invalidValue</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling create pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="178"><div class="step-ref passed">178</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionError')</div></div><div class="time-cell passed">145</div></div><div class="step-row"><div class="step-container" id="178.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell passed">141</div></div><div class="step-row"><div class="step-container" id="179"><div class="step-ref passed">179</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="180"><div class="step-ref passed">180</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="181"><div class="step-ref passed">181</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="182"><div class="step-ref passed">182</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="183"><div class="step-ref passed">183</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="184"><div class="step-ref passed">184</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">137</div></div><div class="step-row"><div class="step-container" id="185"><div class="step-ref passed">185</div><div class="step-indent"> </div><div class="step-cell passed">Then status 400</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="186"><div class="step-ref passed">186</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="187"><div class="step-ref passed">187</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="188"><div class="step-ref passed">188</div><div class="step-cell passed">* match pgServicesCreateResponseBody.Errors[0].message == pgSericesConstant.errorMessages.jsonException</div></div><div class="time-cell passed">2</div></div></div><div class="scenario"><div class="scenario-heading" id="[3:34]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">negative</a><a class="badge badge-primary" href="karate-tags.html">PGCreate_InvalidTenant_04</a><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a></div><span class="scenario-keyword">Scenario: [3:34]</span><span class="scenario-name">Verify creating a payment transaction with invalid/non existent value for "tenatid" in the request body and check for errors </span></div><div class="scenario-time passed">ms: 629</div></div><div class="step-row"><div class="step-container" id="[3:34]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="189"><div class="step-ref bg-step">189</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">254</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="189.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">223</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="190"><div class="step-ref bg-step">190</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="preformatted" data-parent="190">15:40:34.970 karate.env:  
15:40:34.971 locale: en_IN 
15:40:34.972 tenantId: pb.amritsar</div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="191"><div class="step-ref bg-step">191</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="192"><div class="step-ref bg-step">192</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="193"><div class="step-ref bg-step">193</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="194"><div class="step-ref bg-step">194</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="195"><div class="step-ref bg-step">195</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="196"><div class="step-ref bg-step">196</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="197"><div class="step-ref bg-step">197</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="198"><div class="step-ref bg-step">198</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="199"><div class="step-ref bg-step">199</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="200"><div class="step-ref bg-step">200</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="201"><div class="step-ref bg-step">201</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="202"><div class="step-ref bg-step">202</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="203"><div class="step-ref bg-step">203</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="204"><div class="step-ref bg-step">204</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">194</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="204.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">185</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="205"><div class="step-ref bg-step">205</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="206"><div class="step-ref bg-step">206</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="207"><div class="step-ref bg-step">207</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="208"><div class="step-ref bg-step">208</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">13</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="209"><div class="step-ref bg-step">209</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="210"><div class="step-ref bg-step">210</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">10</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="211"><div class="step-ref bg-step">211</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="212"><div class="step-ref bg-step">212</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="213"><div class="step-ref bg-step">213</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="214"><div class="step-ref bg-step">214</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">146</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="215"><div class="step-ref bg-step">215</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="216"><div class="step-ref bg-step">216</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="217"><div class="step-ref bg-step">217</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="218"><div class="step-ref bg-step">218</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="218">15:40:35.215 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590235018,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763035021,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "f1659201-a7e4-4abf-94ac-ac33dfd1e002",
          "taxHeadMasterCode": "PT_TIME_PENALTY",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590235414,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590235414
          },
          "tenantId": "pb.amritsar",
          "id": "ec7678dd-0231-4850-8b40-0f63008989c3",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590235414,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590235414
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-259011",
      "id": "f1659201-a7e4-4abf-94ac-ac33dfd1e002",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="219"><div class="step-ref bg-step">219</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="220"><div class="step-ref bg-step">220</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="221"><div class="step-ref bg-step">221</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="222"><div class="step-ref bg-step">222</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="223"><div class="step-ref bg-step">223</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="224"><div class="step-ref bg-step">224</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="225"><div class="step-ref bg-step">225</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="226"><div class="step-ref bg-step">226</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="227"><div class="step-ref bg-step">227</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="228"><div class="step-ref bg-step">228</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="229"><div class="step-ref bg-step">229</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="230"><div class="step-ref bg-step">230</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="231"><div class="step-ref bg-step">231</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="232"><div class="step-ref bg-step">232</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="233"><div class="step-ref bg-step">233</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="234"><div class="step-ref bg-step">234</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="235"><div class="step-ref bg-step">235</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="236"><div class="step-ref bg-step">236</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="237"><div class="step-ref bg-step">237</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="238"><div class="step-ref bg-step">238</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">206</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="238.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">199</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="239"><div class="step-ref bg-step">239</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">7</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="240"><div class="step-ref bg-step">240</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="241"><div class="step-ref bg-step">241</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="242"><div class="step-ref bg-step">242</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="243"><div class="step-ref bg-step">243</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="244"><div class="step-ref bg-step">244</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="245"><div class="step-ref bg-step">245</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="246"><div class="step-ref bg-step">246</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="247"><div class="step-ref bg-step">247</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="248"><div class="step-ref bg-step">248</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">5</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="249"><div class="step-ref bg-step">249</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="250"><div class="step-ref bg-step">250</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">1</div></div><div class="preformatted" data-parent="250">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="251"><div class="step-ref bg-step">251</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="252"><div class="step-ref bg-step">252</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="253"><div class="step-ref bg-step">253</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="254"><div class="step-ref bg-step">254</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">169</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="255"><div class="step-ref bg-step">255</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="256"><div class="step-ref bg-step">256</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="257"><div class="step-ref bg-step">257</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="258"><div class="step-ref bg-step">258</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="259"><div class="step-ref bg-step">259</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="260"><div class="step-ref bg-step">260</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="261"><div class="step-ref bg-step">261</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="262"><div class="step-ref bg-step">262</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="263"><div class="step-ref bg-step">263</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="264"><div class="step-ref bg-step">264</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="265"><div class="step-ref bg-step">265</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="266"><div class="step-ref bg-step">266</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="267"><div class="step-ref bg-step">267</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="268"><div class="step-ref bg-step">268</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="269"><div class="step-ref bg-step">269</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[3:34]bg"><div class="step-container" id="270"><div class="step-ref bg-step">270</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row"><div class="step-container" id="271"><div class="step-ref passed">271</div><div class="step-cell passed">* def tenantId = commonConstants.invalidParameters.invalidTenantId</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling create pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="272"><div class="step-ref passed">272</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionError')</div></div><div class="time-cell passed">147</div></div><div class="step-row"><div class="step-container" id="272.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell passed">143</div></div><div class="step-row"><div class="step-container" id="273"><div class="step-ref passed">273</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="274"><div class="step-ref passed">274</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="275"><div class="step-ref passed">275</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="276"><div class="step-ref passed">276</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="277"><div class="step-ref passed">277</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="278"><div class="step-ref passed">278</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">140</div></div><div class="step-row"><div class="step-container" id="279"><div class="step-ref passed">279</div><div class="step-indent"> </div><div class="step-cell passed">Then status 400</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="280"><div class="step-ref passed">280</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="281"><div class="step-ref passed">281</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell passed">0</div></div></div><div class="scenario"><div class="scenario-heading" id="[4:41]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">negative</a><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">PGCreate_InvalidGateway_05</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a></div><span class="scenario-keyword">Scenario: [4:41]</span><span class="scenario-name">Verify creating a payment transaction with invalid/non existent value for "gateway" in the request body and check for errors </span></div><div class="scenario-time passed">ms: 640</div></div><div class="step-row"><div class="step-container" id="[4:41]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="282"><div class="step-ref bg-step">282</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">283</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="282.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">245</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="283"><div class="step-ref bg-step">283</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="preformatted" data-parent="283">15:40:35.666 karate.env:  
15:40:35.667 locale: en_IN 
15:40:35.667 tenantId: pb.amritsar</div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="284"><div class="step-ref bg-step">284</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="285"><div class="step-ref bg-step">285</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="286"><div class="step-ref bg-step">286</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="287"><div class="step-ref bg-step">287</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="288"><div class="step-ref bg-step">288</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="289"><div class="step-ref bg-step">289</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="290"><div class="step-ref bg-step">290</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="291"><div class="step-ref bg-step">291</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="292"><div class="step-ref bg-step">292</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="293"><div class="step-ref bg-step">293</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="294"><div class="step-ref bg-step">294</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="295"><div class="step-ref bg-step">295</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="296"><div class="step-ref bg-step">296</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="297"><div class="step-ref bg-step">297</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">220</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="297.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">209</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="298"><div class="step-ref bg-step">298</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="299"><div class="step-ref bg-step">299</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="300"><div class="step-ref bg-step">300</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="301"><div class="step-ref bg-step">301</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">15</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="302"><div class="step-ref bg-step">302</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="303"><div class="step-ref bg-step">303</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">12</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="304"><div class="step-ref bg-step">304</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="305"><div class="step-ref bg-step">305</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="306"><div class="step-ref bg-step">306</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="307"><div class="step-ref bg-step">307</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">168</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="308"><div class="step-ref bg-step">308</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="309"><div class="step-ref bg-step">309</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="310"><div class="step-ref bg-step">310</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="311"><div class="step-ref bg-step">311</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="311">15:40:35.941 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590235719,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763035721,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "f3ed318b-9a16-48bd-a728-1995f9a34d48",
          "taxHeadMasterCode": "PT_DECIMAL_CEILING_DEBIT",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590236130,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590236130
          },
          "tenantId": "pb.amritsar",
          "id": "8dbd3b30-a85f-4204-b1ca-5ecd8a5c7486",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590236130,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590236130
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-7461",
      "id": "f3ed318b-9a16-48bd-a728-1995f9a34d48",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="312"><div class="step-ref bg-step">312</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="313"><div class="step-ref bg-step">313</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="314"><div class="step-ref bg-step">314</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="315"><div class="step-ref bg-step">315</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="316"><div class="step-ref bg-step">316</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="317"><div class="step-ref bg-step">317</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="318"><div class="step-ref bg-step">318</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="319"><div class="step-ref bg-step">319</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="320"><div class="step-ref bg-step">320</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="321"><div class="step-ref bg-step">321</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="322"><div class="step-ref bg-step">322</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="323"><div class="step-ref bg-step">323</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="324"><div class="step-ref bg-step">324</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="325"><div class="step-ref bg-step">325</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="326"><div class="step-ref bg-step">326</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="327"><div class="step-ref bg-step">327</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="328"><div class="step-ref bg-step">328</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="329"><div class="step-ref bg-step">329</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="330"><div class="step-ref bg-step">330</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="331"><div class="step-ref bg-step">331</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">195</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="331.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">185</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="332"><div class="step-ref bg-step">332</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">7</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="333"><div class="step-ref bg-step">333</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="334"><div class="step-ref bg-step">334</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="335"><div class="step-ref bg-step">335</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="336"><div class="step-ref bg-step">336</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="337"><div class="step-ref bg-step">337</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="338"><div class="step-ref bg-step">338</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="339"><div class="step-ref bg-step">339</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="340"><div class="step-ref bg-step">340</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="341"><div class="step-ref bg-step">341</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="342"><div class="step-ref bg-step">342</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="343"><div class="step-ref bg-step">343</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="343">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="344"><div class="step-ref bg-step">344</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="345"><div class="step-ref bg-step">345</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="346"><div class="step-ref bg-step">346</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="347"><div class="step-ref bg-step">347</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">159</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="348"><div class="step-ref bg-step">348</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="349"><div class="step-ref bg-step">349</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="350"><div class="step-ref bg-step">350</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="351"><div class="step-ref bg-step">351</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="352"><div class="step-ref bg-step">352</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="353"><div class="step-ref bg-step">353</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="354"><div class="step-ref bg-step">354</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="355"><div class="step-ref bg-step">355</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="356"><div class="step-ref bg-step">356</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="357"><div class="step-ref bg-step">357</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="358"><div class="step-ref bg-step">358</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="359"><div class="step-ref bg-step">359</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="360"><div class="step-ref bg-step">360</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="361"><div class="step-ref bg-step">361</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="362"><div class="step-ref bg-step">362</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[4:41]bg"><div class="step-container" id="363"><div class="step-ref bg-step">363</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">7</div></div><div class="step-row"><div class="step-container" id="364"><div class="step-ref passed">364</div><div class="step-cell passed">* def gateway = commonConstants.invalidParameters.invalidValue</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling create pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="365"><div class="step-ref passed">365</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionError')</div></div><div class="time-cell passed">141</div></div><div class="step-row"><div class="step-container" id="365.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell passed">137</div></div><div class="step-row"><div class="step-container" id="366"><div class="step-ref passed">366</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="367"><div class="step-ref passed">367</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="368"><div class="step-ref passed">368</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="369"><div class="step-ref passed">369</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="370"><div class="step-ref passed">370</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="371"><div class="step-ref passed">371</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">133</div></div><div class="step-row"><div class="step-container" id="372"><div class="step-ref passed">372</div><div class="step-indent"> </div><div class="step-cell passed">Then status 400</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="373"><div class="step-ref passed">373</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="374"><div class="step-ref passed">374</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell passed">0</div></div></div><div class="scenario"><div class="scenario-heading" id="[6:62]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">PGCreate_AmtVal_07</a><a class="badge badge-primary" href="karate-tags.html">negative</a><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a></div><span class="scenario-keyword">Scenario: [6:62]</span><span class="scenario-name">Verify creating a payment transaction by passing a txn amount which is not equal to the amount paid </span></div><div class="scenario-time passed">ms: 773</div></div><div class="step-row"><div class="step-container" id="[6:62]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="375"><div class="step-ref bg-step">375</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">225</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="375.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">198</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="376"><div class="step-ref bg-step">376</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">3</div></div><div class="preformatted" data-parent="376">15:40:36.375 karate.env:  
15:40:36.376 locale: en_IN 
15:40:36.376 tenantId: pb.amritsar</div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="377"><div class="step-ref bg-step">377</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="378"><div class="step-ref bg-step">378</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="379"><div class="step-ref bg-step">379</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="380"><div class="step-ref bg-step">380</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="381"><div class="step-ref bg-step">381</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="382"><div class="step-ref bg-step">382</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="383"><div class="step-ref bg-step">383</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="384"><div class="step-ref bg-step">384</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="385"><div class="step-ref bg-step">385</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="386"><div class="step-ref bg-step">386</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="387"><div class="step-ref bg-step">387</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="388"><div class="step-ref bg-step">388</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="389"><div class="step-ref bg-step">389</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="390"><div class="step-ref bg-step">390</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">170</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="390.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">163</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="391"><div class="step-ref bg-step">391</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="392"><div class="step-ref bg-step">392</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="393"><div class="step-ref bg-step">393</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="394"><div class="step-ref bg-step">394</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">11</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="395"><div class="step-ref bg-step">395</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="396"><div class="step-ref bg-step">396</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="397"><div class="step-ref bg-step">397</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">5</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="398"><div class="step-ref bg-step">398</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="399"><div class="step-ref bg-step">399</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="400"><div class="step-ref bg-step">400</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">130</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="401"><div class="step-ref bg-step">401</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="402"><div class="step-ref bg-step">402</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="403"><div class="step-ref bg-step">403</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="404"><div class="step-ref bg-step">404</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="404">15:40:36.591 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590236416,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763036418,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "f8eb2cdf-e3d9-4c4e-b459-f7d49bedfc2b",
          "taxHeadMasterCode": "PT_TIME_REBATE",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590236794,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590236794
          },
          "tenantId": "pb.amritsar",
          "id": "14386468-00b5-4716-acde-afdda934f522",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590236794,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590236794
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-317654",
      "id": "f8eb2cdf-e3d9-4c4e-b459-f7d49bedfc2b",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="405"><div class="step-ref bg-step">405</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="406"><div class="step-ref bg-step">406</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="407"><div class="step-ref bg-step">407</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="408"><div class="step-ref bg-step">408</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="409"><div class="step-ref bg-step">409</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="410"><div class="step-ref bg-step">410</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="411"><div class="step-ref bg-step">411</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="412"><div class="step-ref bg-step">412</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="413"><div class="step-ref bg-step">413</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="414"><div class="step-ref bg-step">414</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="415"><div class="step-ref bg-step">415</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="416"><div class="step-ref bg-step">416</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="417"><div class="step-ref bg-step">417</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="418"><div class="step-ref bg-step">418</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="419"><div class="step-ref bg-step">419</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="420"><div class="step-ref bg-step">420</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="421"><div class="step-ref bg-step">421</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="422"><div class="step-ref bg-step">422</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="423"><div class="step-ref bg-step">423</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="424"><div class="step-ref bg-step">424</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">362</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="424.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">351</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="425"><div class="step-ref bg-step">425</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">10</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="426"><div class="step-ref bg-step">426</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="427"><div class="step-ref bg-step">427</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="428"><div class="step-ref bg-step">428</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="429"><div class="step-ref bg-step">429</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="430"><div class="step-ref bg-step">430</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">9</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="431"><div class="step-ref bg-step">431</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="432"><div class="step-ref bg-step">432</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="433"><div class="step-ref bg-step">433</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="434"><div class="step-ref bg-step">434</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">14</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="435"><div class="step-ref bg-step">435</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="436"><div class="step-ref bg-step">436</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="436">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="437"><div class="step-ref bg-step">437</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="438"><div class="step-ref bg-step">438</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="439"><div class="step-ref bg-step">439</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="440"><div class="step-ref bg-step">440</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">304</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="441"><div class="step-ref bg-step">441</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="442"><div class="step-ref bg-step">442</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="443"><div class="step-ref bg-step">443</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="444"><div class="step-ref bg-step">444</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="445"><div class="step-ref bg-step">445</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="446"><div class="step-ref bg-step">446</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="447"><div class="step-ref bg-step">447</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="448"><div class="step-ref bg-step">448</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="449"><div class="step-ref bg-step">449</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="450"><div class="step-ref bg-step">450</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="451"><div class="step-ref bg-step">451</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="452"><div class="step-ref bg-step">452</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="453"><div class="step-ref bg-step">453</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="454"><div class="step-ref bg-step">454</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="455"><div class="step-ref bg-step">455</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[6:62]bg"><div class="step-container" id="456"><div class="step-ref bg-step">456</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">7</div></div><div class="step-row"><div class="step-container" id="457"><div class="step-ref passed">457</div><div class="step-cell passed">* def txnAmount = txnAmount+100</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling create pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="458"><div class="step-ref passed">458</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionError')</div></div><div class="time-cell passed">166</div></div><div class="step-row"><div class="step-container" id="458.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell passed">163</div></div><div class="step-row"><div class="step-container" id="459"><div class="step-ref passed">459</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="460"><div class="step-ref passed">460</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="461"><div class="step-ref passed">461</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="462"><div class="step-ref passed">462</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="463"><div class="step-ref passed">463</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="464"><div class="step-ref passed">464</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">160</div></div><div class="step-row"><div class="step-container" id="465"><div class="step-ref passed">465</div><div class="step-indent"> </div><div class="step-cell passed">Then status 400</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="466"><div class="step-ref passed">466</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="467"><div class="step-ref passed">467</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell passed">0</div></div></div><div class="scenario"><div class="scenario-heading" id="[7:70]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">negative</a><a class="badge badge-primary" href="karate-tags.html">PGCreate_ExpBill_08</a><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a></div><span class="scenario-keyword">Scenario: [7:70]</span><span class="scenario-name">Verify creating a payment transaction by passing a bill id which is expired </span></div><div class="scenario-time failed">ms: 1385</div></div><div class="step-row"><div class="step-container" id="[7:70]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="468"><div class="step-ref bg-step">468</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">245</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="468.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">215</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="469"><div class="step-ref bg-step">469</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="preformatted" data-parent="469">15:40:37.214 karate.env:  
15:40:37.215 locale: en_IN 
15:40:37.215 tenantId: pb.amritsar</div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="470"><div class="step-ref bg-step">470</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="471"><div class="step-ref bg-step">471</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="472"><div class="step-ref bg-step">472</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="473"><div class="step-ref bg-step">473</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="474"><div class="step-ref bg-step">474</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="475"><div class="step-ref bg-step">475</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="476"><div class="step-ref bg-step">476</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="477"><div class="step-ref bg-step">477</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="478"><div class="step-ref bg-step">478</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="479"><div class="step-ref bg-step">479</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="480"><div class="step-ref bg-step">480</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="481"><div class="step-ref bg-step">481</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="482"><div class="step-ref bg-step">482</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="483"><div class="step-ref bg-step">483</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">183</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="483.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">174</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="484"><div class="step-ref bg-step">484</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="485"><div class="step-ref bg-step">485</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="486"><div class="step-ref bg-step">486</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="487"><div class="step-ref bg-step">487</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">14</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="488"><div class="step-ref bg-step">488</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="489"><div class="step-ref bg-step">489</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">12</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="490"><div class="step-ref bg-step">490</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="491"><div class="step-ref bg-step">491</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="492"><div class="step-ref bg-step">492</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="493"><div class="step-ref bg-step">493</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">134</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="494"><div class="step-ref bg-step">494</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="495"><div class="step-ref bg-step">495</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="496"><div class="step-ref bg-step">496</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="497"><div class="step-ref bg-step">497</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="497">15:40:37.453 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590237262,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763037265,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "5aa7634c-effe-49e7-8351-c4940a9e60a4",
          "taxHeadMasterCode": "PT_TIME_REBATE",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590237654,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590237654
          },
          "tenantId": "pb.amritsar",
          "id": "17a53d31-1e9d-4608-842b-3eb23fe9d9d7",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590237654,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590237654
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-109229",
      "id": "5aa7634c-effe-49e7-8351-c4940a9e60a4",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="498"><div class="step-ref bg-step">498</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="499"><div class="step-ref bg-step">499</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="500"><div class="step-ref bg-step">500</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="501"><div class="step-ref bg-step">501</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="502"><div class="step-ref bg-step">502</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="503"><div class="step-ref bg-step">503</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="504"><div class="step-ref bg-step">504</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="505"><div class="step-ref bg-step">505</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="506"><div class="step-ref bg-step">506</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="507"><div class="step-ref bg-step">507</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="508"><div class="step-ref bg-step">508</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="509"><div class="step-ref bg-step">509</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="510"><div class="step-ref bg-step">510</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="511"><div class="step-ref bg-step">511</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="512"><div class="step-ref bg-step">512</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="513"><div class="step-ref bg-step">513</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="514"><div class="step-ref bg-step">514</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="515"><div class="step-ref bg-step">515</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="516"><div class="step-ref bg-step">516</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="517"><div class="step-ref bg-step">517</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">215</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="517.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">206</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="518"><div class="step-ref bg-step">518</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">6</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="519"><div class="step-ref bg-step">519</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="520"><div class="step-ref bg-step">520</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="521"><div class="step-ref bg-step">521</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="522"><div class="step-ref bg-step">522</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="523"><div class="step-ref bg-step">523</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="524"><div class="step-ref bg-step">524</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="525"><div class="step-ref bg-step">525</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="526"><div class="step-ref bg-step">526</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="527"><div class="step-ref bg-step">527</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="528"><div class="step-ref bg-step">528</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="529"><div class="step-ref bg-step">529</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="529">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="530"><div class="step-ref bg-step">530</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="531"><div class="step-ref bg-step">531</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="532"><div class="step-ref bg-step">532</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="533"><div class="step-ref bg-step">533</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">180</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="534"><div class="step-ref bg-step">534</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="535"><div class="step-ref bg-step">535</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="536"><div class="step-ref bg-step">536</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="537"><div class="step-ref bg-step">537</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="538"><div class="step-ref bg-step">538</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="539"><div class="step-ref bg-step">539</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="540"><div class="step-ref bg-step">540</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="541"><div class="step-ref bg-step">541</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="542"><div class="step-ref bg-step">542</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="543"><div class="step-ref bg-step">543</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="544"><div class="step-ref bg-step">544</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="545"><div class="step-ref bg-step">545</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="546"><div class="step-ref bg-step">546</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="547"><div class="step-ref bg-step">547</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="548"><div class="step-ref bg-step">548</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[7:70]bg"><div class="step-container" id="549"><div class="step-ref bg-step">549</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">6</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling create pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="550"><div class="step-ref passed">550</div><div class="step-cell passed">* def consumerCode = 'PT-Test-' + ranInteger(6)</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="551"><div class="step-ref passed">551</div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="552"><div class="step-ref passed">552</div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="553"><div class="step-ref passed">553</div><div class="step-cell passed">* def taxPeriodFrom = getPastEpochDate(2)</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="554"><div class="step-ref passed">554</div><div class="step-cell passed">* def taxPeriodTo = getPastEpochDate(1)</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="555"><div class="step-ref passed">555</div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="556"><div class="step-ref passed">556</div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="557"><div class="step-ref passed">557</div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="558"><div class="step-ref passed">558</div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="559"><div class="step-ref passed">559</div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="560"><div class="step-ref passed">560</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">187</div></div><div class="step-row"><div class="step-container" id="560.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">177</div></div><div class="step-row"><div class="step-container" id="561"><div class="step-ref passed">561</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">8</div></div><div class="step-row"><div class="step-container" id="562"><div class="step-ref passed">562</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="563"><div class="step-ref passed">563</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="564"><div class="step-ref passed">564</div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">7</div></div><div class="step-row"><div class="step-container" id="565"><div class="step-ref passed">565</div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="566"><div class="step-ref passed">566</div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row"><div class="step-container" id="567"><div class="step-ref passed">567</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">4</div></div><div class="step-row"><div class="step-container" id="568"><div class="step-ref passed">568</div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="569"><div class="step-ref passed">569</div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="570"><div class="step-ref passed">570</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">139</div></div><div class="step-row"><div class="step-container" id="571"><div class="step-ref passed">571</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="572"><div class="step-ref passed">572</div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="573"><div class="step-ref passed">573</div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="574"><div class="step-ref passed">574</div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="574">15:40:37.888 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628417437701,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628503837703,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "52f55c83-79fc-4130-87ac-2dd39e3ebdea",
          "taxHeadMasterCode": "PT_TAX",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590238087,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590238087
          },
          "tenantId": "pb.amritsar",
          "id": "352c5d65-ebc3-4f9e-8218-3dd528118933",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590238087,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590238087
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "PT-Test-121173",
      "id": "52f55c83-79fc-4130-87ac-2dd39e3ebdea",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row"><div class="step-container" id="575"><div class="step-ref passed">575</div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="576"><div class="step-ref passed">576</div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="577"><div class="step-ref passed">577</div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="578"><div class="step-ref passed">578</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">190</div></div><div class="step-row"><div class="step-container" id="578.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">177</div></div><div class="step-row"><div class="step-container" id="579"><div class="step-ref passed">579</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row"><div class="step-container" id="580"><div class="step-ref passed">580</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="581"><div class="step-ref passed">581</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">3</div></div><div class="step-row"><div class="step-container" id="582"><div class="step-ref passed">582</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="583"><div class="step-ref passed">583</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="584"><div class="step-ref passed">584</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="585"><div class="step-ref passed">585</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="586"><div class="step-ref passed">586</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="587"><div class="step-ref passed">587</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="588"><div class="step-ref passed">588</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">9</div></div><div class="step-row"><div class="step-container" id="589"><div class="step-ref passed">589</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="590"><div class="step-ref passed">590</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="590">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row"><div class="step-container" id="591"><div class="step-ref passed">591</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="592"><div class="step-ref passed">592</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="593"><div class="step-ref passed">593</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="594"><div class="step-ref passed">594</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">149</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="595"><div class="step-ref passed">595</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="596"><div class="step-ref passed">596</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="597"><div class="step-ref passed">597</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="598"><div class="step-ref passed">598</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="599"><div class="step-ref passed">599</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="600"><div class="step-ref passed">600</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="601"><div class="step-ref passed">601</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="602"><div class="step-ref failed">602</div><div class="step-cell failed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionError')</div></div><div class="time-cell failed">518</div></div><div class="preformatted" data-parent="602">15:40:38.602 feature call failed: classpath:com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature
arg: null
pgServiceCreate.feature:24 - status code was: 200, expected: 400, response time: 501, url: https://qa.digit.org/pg-service/transaction/v1/_create?, response: {"ResponseInfo":{"ver":null,"resMsgId":"uief87324","msgId":null,"apiId":null,"ts":null,"status":"SUCCESSFUL"},"Transaction":{"redirectUrl":"https://migs.mastercard.co.in/vpcpay?vpc_AccessCode=B26A7B34&amp;vpc_Amount=20000&amp;vpc_Version=1&amp;vpc_MerchTxnRef=PB_PG_2021_08_10_006522_14&amp;vpc_OrderInfo=91101055559214&amp;vpc_Command=pay&amp;vpc_Currency=INR&amp;vpc_Merchant=TESTLCGOPJTXMIGS&amp;vpc_Locale=en_IN&amp;vpc_ReturnURL=https://qa.digit.org/citizen/egov-common/paymentRedirectPage?eg_pg_txnid%3DPB_PG_2021_08_10_006522_14&amp;vpc_SecureHash=4C66DF4113F2B54C6EA80E44E17672FAF1895246FE026550C4E5996D4BAB28C7&amp;vpc_SecureHashType=SHA256","gatewayTxnId":null,"gatewayPaymentMode":null,"module":"PT","gatewayStatusMsg":null,"txnStatusMsg":"Transaction initiated","additionalDetails":{"taxAndPayments":[{"amountPaid":200.0,"billId":"1a33b53f-4220-44fc-ab40-7e38ea928320","taxAmount":null}]},"productInfo":"Common Payment","gatewayStatusCode":null,"taxAndPayments":[{"amountPaid":200.0,"billId":"1a33b53f-4220-44fc-ab40-7e38ea928320","taxAmount":null}],"txnStatus":"PENDING","billId":"1a33b53f-4220-44fc-ab40-7e38ea928320","auditDetails":{"lastModifiedTime":null,"createdBy":"959745fe-66bc-45b2-9a35-609ec994abd4","lastModifiedBy":null,"createdTime":1628590238794},"tenantId":"pb.amritsar","consumerCode":"PT-Test-121173","callbackUrl":"https://qa.digit.org/citizen/egov-common/paymentRedirectPage?eg_pg_txnid=PB_PG_2021_08_10_006522_14","receipt":null,"user":{"mobileNumber":"7861259013","name":"User nreRzoBWqS","tenantId":"pb","emailId":null,"userName":"User nreRzoBWqS","uuid":"1e4b5538-240f-419b-b66a-cf43aab918c4"},"txnAmount":"200.0","gateway":"AXIS","txnId":"PB_PG_2021_08_10_006522_14"}}
pgServices.feature:84 - 
pgServiceCreate.feature:24 - status code was: 200, expected: 400, response time: 501, url: https://qa.digit.org/pg-service/transaction/v1/_create?, response: {"ResponseInfo":{"ver":null,"resMsgId":"uief87324","msgId":null,"apiId":null,"ts":null,"status":"SUCCESSFUL"},"Transaction":{"redirectUrl":"https://migs.mastercard.co.in/vpcpay?vpc_AccessCode=B26A7B34&amp;vpc_Amount=20000&amp;vpc_Version=1&amp;vpc_MerchTxnRef=PB_PG_2021_08_10_006522_14&amp;vpc_OrderInfo=91101055559214&amp;vpc_Command=pay&amp;vpc_Currency=INR&amp;vpc_Merchant=TESTLCGOPJTXMIGS&amp;vpc_Locale=en_IN&amp;vpc_ReturnURL=https://qa.digit.org/citizen/egov-common/paymentRedirectPage?eg_pg_txnid%3DPB_PG_2021_08_10_006522_14&amp;vpc_SecureHash=4C66DF4113F2B54C6EA80E44E17672FAF1895246FE026550C4E5996D4BAB28C7&amp;vpc_SecureHashType=SHA256","gatewayTxnId":null,"gatewayPaymentMode":null,"module":"PT","gatewayStatusMsg":null,"txnStatusMsg":"Transaction initiated","additionalDetails":{"taxAndPayments":[{"amountPaid":200.0,"billId":"1a33b53f-4220-44fc-ab40-7e38ea928320","taxAmount":null}]},"productInfo":"Common Payment","gatewayStatusCode":null,"taxAndPayments":[{"amountPaid":200.0,"billId":"1a33b53f-4220-44fc-ab40-7e38ea928320","taxAmount":null}],"txnStatus":"PENDING","billId":"1a33b53f-4220-44fc-ab40-7e38ea928320","auditDetails":{"lastModifiedTime":null,"createdBy":"959745fe-66bc-45b2-9a35-609ec994abd4","lastModifiedBy":null,"createdTime":1628590238794},"tenantId":"pb.amritsar","consumerCode":"PT-Test-121173","callbackUrl":"https://qa.digit.org/citizen/egov-common/paymentRedirectPage?eg_pg_txnid=PB_PG_2021_08_10_006522_14","receipt":null,"user":{"mobileNumber":"7861259013","name":"User nreRzoBWqS","tenantId":"pb","emailId":null,"userName":"User nreRzoBWqS","uuid":"1e4b5538-240f-419b-b66a-cf43aab918c4"},"txnAmount":"200.0","gateway":"AXIS","txnId":"PB_PG_2021_08_10_006522_14"}}</div><div class="step-row"><div class="step-container" id="602.1"><div class="step-ref failed">&gt;&gt;</div><div class="step-cell failed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell failed">514</div></div><div class="step-row"><div class="step-container" id="603"><div class="step-ref passed">603</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="604"><div class="step-ref passed">604</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="605"><div class="step-ref passed">605</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">9</div></div><div class="step-row"><div class="step-container" id="606"><div class="step-ref passed">606</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="607"><div class="step-ref passed">607</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="608"><div class="step-ref passed">608</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">503</div></div><div class="step-row"><div class="step-container" id="609"><div class="step-ref failed">609</div><div class="step-indent"> </div><div class="step-cell failed">Then status 400</div></div><div class="time-cell failed">0</div></div><div class="preformatted" data-parent="609">15:40:38.602 status code was: 200, expected: 400, response time: 501, url: https://qa.digit.org/pg-service/transaction/v1/_create?, response: {"ResponseInfo":{"ver":null,"resMsgId":"uief87324","msgId":null,"apiId":null,"ts":null,"status":"SUCCESSFUL"},"Transaction":{"redirectUrl":"https://migs.mastercard.co.in/vpcpay?vpc_AccessCode=B26A7B34&amp;vpc_Amount=20000&amp;vpc_Version=1&amp;vpc_MerchTxnRef=PB_PG_2021_08_10_006522_14&amp;vpc_OrderInfo=91101055559214&amp;vpc_Command=pay&amp;vpc_Currency=INR&amp;vpc_Merchant=TESTLCGOPJTXMIGS&amp;vpc_Locale=en_IN&amp;vpc_ReturnURL=https://qa.digit.org/citizen/egov-common/paymentRedirectPage?eg_pg_txnid%3DPB_PG_2021_08_10_006522_14&amp;vpc_SecureHash=4C66DF4113F2B54C6EA80E44E17672FAF1895246FE026550C4E5996D4BAB28C7&amp;vpc_SecureHashType=SHA256","gatewayTxnId":null,"gatewayPaymentMode":null,"module":"PT","gatewayStatusMsg":null,"txnStatusMsg":"Transaction initiated","additionalDetails":{"taxAndPayments":[{"amountPaid":200.0,"billId":"1a33b53f-4220-44fc-ab40-7e38ea928320","taxAmount":null}]},"productInfo":"Common Payment","gatewayStatusCode":null,"taxAndPayments":[{"amountPaid":200.0,"billId":"1a33b53f-4220-44fc-ab40-7e38ea928320","taxAmount":null}],"txnStatus":"PENDING","billId":"1a33b53f-4220-44fc-ab40-7e38ea928320","auditDetails":{"lastModifiedTime":null,"createdBy":"959745fe-66bc-45b2-9a35-609ec994abd4","lastModifiedBy":null,"createdTime":1628590238794},"tenantId":"pb.amritsar","consumerCode":"PT-Test-121173","callbackUrl":"https://qa.digit.org/citizen/egov-common/paymentRedirectPage?eg_pg_txnid=PB_PG_2021_08_10_006522_14","receipt":null,"user":{"mobileNumber":"7861259013","name":"User nreRzoBWqS","tenantId":"pb","emailId":null,"userName":"User nreRzoBWqS","uuid":"1e4b5538-240f-419b-b66a-cf43aab918c4"},"txnAmount":"200.0","gateway":"AXIS","txnId":"PB_PG_2021_08_10_006522_14"}}
pgServiceCreate.feature:24 - status code was: 200, expected: 400, response time: 501, url: https://qa.digit.org/pg-service/transaction/v1/_create?, response: {"ResponseInfo":{"ver":null,"resMsgId":"uief87324","msgId":null,"apiId":null,"ts":null,"status":"SUCCESSFUL"},"Transaction":{"redirectUrl":"https://migs.mastercard.co.in/vpcpay?vpc_AccessCode=B26A7B34&amp;vpc_Amount=20000&amp;vpc_Version=1&amp;vpc_MerchTxnRef=PB_PG_2021_08_10_006522_14&amp;vpc_OrderInfo=91101055559214&amp;vpc_Command=pay&amp;vpc_Currency=INR&amp;vpc_Merchant=TESTLCGOPJTXMIGS&amp;vpc_Locale=en_IN&amp;vpc_ReturnURL=https://qa.digit.org/citizen/egov-common/paymentRedirectPage?eg_pg_txnid%3DPB_PG_2021_08_10_006522_14&amp;vpc_SecureHash=4C66DF4113F2B54C6EA80E44E17672FAF1895246FE026550C4E5996D4BAB28C7&amp;vpc_SecureHashType=SHA256","gatewayTxnId":null,"gatewayPaymentMode":null,"module":"PT","gatewayStatusMsg":null,"txnStatusMsg":"Transaction initiated","additionalDetails":{"taxAndPayments":[{"amountPaid":200.0,"billId":"1a33b53f-4220-44fc-ab40-7e38ea928320","taxAmount":null}]},"productInfo":"Common Payment","gatewayStatusCode":null,"taxAndPayments":[{"amountPaid":200.0,"billId":"1a33b53f-4220-44fc-ab40-7e38ea928320","taxAmount":null}],"txnStatus":"PENDING","billId":"1a33b53f-4220-44fc-ab40-7e38ea928320","auditDetails":{"lastModifiedTime":null,"createdBy":"959745fe-66bc-45b2-9a35-609ec994abd4","lastModifiedBy":null,"createdTime":1628590238794},"tenantId":"pb.amritsar","consumerCode":"PT-Test-121173","callbackUrl":"https://qa.digit.org/citizen/egov-common/paymentRedirectPage?eg_pg_txnid=PB_PG_2021_08_10_006522_14","receipt":null,"user":{"mobileNumber":"7861259013","name":"User nreRzoBWqS","tenantId":"pb","emailId":null,"userName":"User nreRzoBWqS","uuid":"1e4b5538-240f-419b-b66a-cf43aab918c4"},"txnAmount":"200.0","gateway":"AXIS","txnId":"PB_PG_2021_08_10_006522_14"}}</div><div class="step-row"><div class="step-container" id="610"><div class="step-ref skipped">610</div><div class="step-indent"> </div><div class="step-cell skipped">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell skipped">0</div></div><div class="step-row"><div class="step-container" id="611"><div class="step-ref skipped">611</div><div class="step-indent"> </div><div class="step-cell skipped">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell skipped">0</div></div></div><div class="scenario"><div class="scenario-heading" id="[8:88]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">negative</a><a class="badge badge-primary" href="karate-tags.html">PGCreate_AmtValDue_09</a><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a></div><span class="scenario-keyword">Scenario: [8:88]</span><span class="scenario-name">Verify creating a payment transaction by passing a amount which is greater than amount due </span></div><div class="scenario-time passed">ms: 620</div></div><div class="step-row"><div class="step-container" id="[8:88]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="612"><div class="step-ref bg-step">612</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">260</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="612.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">233</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="613"><div class="step-ref bg-step">613</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="preformatted" data-parent="613">15:40:38.693 karate.env:  
15:40:38.694 locale: en_IN 
15:40:38.694 tenantId: pb.amritsar</div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="614"><div class="step-ref bg-step">614</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="615"><div class="step-ref bg-step">615</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="616"><div class="step-ref bg-step">616</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="617"><div class="step-ref bg-step">617</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="618"><div class="step-ref bg-step">618</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="619"><div class="step-ref bg-step">619</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="620"><div class="step-ref bg-step">620</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="621"><div class="step-ref bg-step">621</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="622"><div class="step-ref bg-step">622</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="623"><div class="step-ref bg-step">623</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="624"><div class="step-ref bg-step">624</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="625"><div class="step-ref bg-step">625</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="626"><div class="step-ref bg-step">626</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="627"><div class="step-ref bg-step">627</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">199</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="627.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">188</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="628"><div class="step-ref bg-step">628</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="629"><div class="step-ref bg-step">629</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="630"><div class="step-ref bg-step">630</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="631"><div class="step-ref bg-step">631</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">9</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="632"><div class="step-ref bg-step">632</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="633"><div class="step-ref bg-step">633</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">14</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="634"><div class="step-ref bg-step">634</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="635"><div class="step-ref bg-step">635</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="636"><div class="step-ref bg-step">636</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="637"><div class="step-ref bg-step">637</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">150</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="638"><div class="step-ref bg-step">638</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="639"><div class="step-ref bg-step">639</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="640"><div class="step-ref bg-step">640</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="641"><div class="step-ref bg-step">641</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="641">15:40:38.942 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590238740,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763038742,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "07fce5ca-993b-4861-a4d0-24272738a0c0",
          "taxHeadMasterCode": "PT_ADHOC_PENALTY",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590239139,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590239139
          },
          "tenantId": "pb.amritsar",
          "id": "3b0f4af8-65f6-43d7-82f2-d012ad9f5321",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590239139,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590239139
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-458168",
      "id": "07fce5ca-993b-4861-a4d0-24272738a0c0",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="642"><div class="step-ref bg-step">642</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="643"><div class="step-ref bg-step">643</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="644"><div class="step-ref bg-step">644</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="645"><div class="step-ref bg-step">645</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="646"><div class="step-ref bg-step">646</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="647"><div class="step-ref bg-step">647</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="648"><div class="step-ref bg-step">648</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="649"><div class="step-ref bg-step">649</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="650"><div class="step-ref bg-step">650</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="651"><div class="step-ref bg-step">651</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="652"><div class="step-ref bg-step">652</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">5</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="653"><div class="step-ref bg-step">653</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="654"><div class="step-ref bg-step">654</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="655"><div class="step-ref bg-step">655</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="656"><div class="step-ref bg-step">656</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="657"><div class="step-ref bg-step">657</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="658"><div class="step-ref bg-step">658</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="659"><div class="step-ref bg-step">659</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="660"><div class="step-ref bg-step">660</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="661"><div class="step-ref bg-step">661</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">180</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="661.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">169</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="662"><div class="step-ref bg-step">662</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="663"><div class="step-ref bg-step">663</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">5</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="664"><div class="step-ref bg-step">664</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="665"><div class="step-ref bg-step">665</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="666"><div class="step-ref bg-step">666</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="667"><div class="step-ref bg-step">667</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="668"><div class="step-ref bg-step">668</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="669"><div class="step-ref bg-step">669</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="670"><div class="step-ref bg-step">670</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="671"><div class="step-ref bg-step">671</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="672"><div class="step-ref bg-step">672</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="673"><div class="step-ref bg-step">673</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="673">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="674"><div class="step-ref bg-step">674</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="675"><div class="step-ref bg-step">675</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="676"><div class="step-ref bg-step">676</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="677"><div class="step-ref bg-step">677</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">141</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="678"><div class="step-ref bg-step">678</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="679"><div class="step-ref bg-step">679</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="680"><div class="step-ref bg-step">680</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="681"><div class="step-ref bg-step">681</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="682"><div class="step-ref bg-step">682</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="683"><div class="step-ref bg-step">683</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="684"><div class="step-ref bg-step">684</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="685"><div class="step-ref bg-step">685</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="686"><div class="step-ref bg-step">686</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="687"><div class="step-ref bg-step">687</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="688"><div class="step-ref bg-step">688</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="689"><div class="step-ref bg-step">689</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="690"><div class="step-ref bg-step">690</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="691"><div class="step-ref bg-step">691</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="692"><div class="step-ref bg-step">692</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[8:88]bg"><div class="step-container" id="693"><div class="step-ref bg-step">693</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">10</div></div><div class="step-row"><div class="step-container" id="694"><div class="step-ref passed">694</div><div class="step-cell passed">* def txnAmount = txnAmount+'0'</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling create pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="695"><div class="step-ref passed">695</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionError')</div></div><div class="time-cell passed">148</div></div><div class="step-row"><div class="step-container" id="695.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell passed">144</div></div><div class="step-row"><div class="step-container" id="696"><div class="step-ref passed">696</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="697"><div class="step-ref passed">697</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="698"><div class="step-ref passed">698</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="699"><div class="step-ref passed">699</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="700"><div class="step-ref passed">700</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="701"><div class="step-ref passed">701</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">138</div></div><div class="step-row"><div class="step-container" id="702"><div class="step-ref passed">702</div><div class="step-indent"> </div><div class="step-cell passed">Then status 400</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="703"><div class="step-ref passed">703</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="704"><div class="step-ref passed">704</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell passed">0</div></div></div><div class="scenario"><div class="scenario-heading" id="[9:95]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">negative</a><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">PGCreate_InvalidBillID_10</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a></div><span class="scenario-keyword">Scenario: [9:95]</span><span class="scenario-name">Verify creating a payment transaction with invalid/non existent value for "bill id" in the request body and check for errors </span></div><div class="scenario-time passed">ms: 804</div></div><div class="step-row"><div class="step-container" id="[9:95]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="705"><div class="step-ref bg-step">705</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">398</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="705.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">232</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="706"><div class="step-ref bg-step">706</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="preformatted" data-parent="706">15:40:39.381 karate.env:  
15:40:39.381 locale: en_IN 
15:40:39.381 tenantId: pb.amritsar</div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="707"><div class="step-ref bg-step">707</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="708"><div class="step-ref bg-step">708</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="709"><div class="step-ref bg-step">709</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="710"><div class="step-ref bg-step">710</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="711"><div class="step-ref bg-step">711</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="712"><div class="step-ref bg-step">712</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="713"><div class="step-ref bg-step">713</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="714"><div class="step-ref bg-step">714</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="715"><div class="step-ref bg-step">715</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="716"><div class="step-ref bg-step">716</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="717"><div class="step-ref bg-step">717</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="718"><div class="step-ref bg-step">718</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="719"><div class="step-ref bg-step">719</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="720"><div class="step-ref bg-step">720</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">209</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="720.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">197</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="721"><div class="step-ref bg-step">721</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="722"><div class="step-ref bg-step">722</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="723"><div class="step-ref bg-step">723</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="724"><div class="step-ref bg-step">724</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="725"><div class="step-ref bg-step">725</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="726"><div class="step-ref bg-step">726</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">11</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="727"><div class="step-ref bg-step">727</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="728"><div class="step-ref bg-step">728</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="729"><div class="step-ref bg-step">729</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="730"><div class="step-ref bg-step">730</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">160</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="731"><div class="step-ref bg-step">731</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="732"><div class="step-ref bg-step">732</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="733"><div class="step-ref bg-step">733</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="734"><div class="step-ref bg-step">734</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="734">15:40:39.769 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590239562,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763039564,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "e6f012fa-f123-41f4-86ad-4a2e04ac1e6a",
          "taxHeadMasterCode": "PT_FIRE_CESS",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590239965,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590239965
          },
          "tenantId": "pb.amritsar",
          "id": "b54b0f16-a2ac-4158-9f05-5ce5f085ae31",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590239965,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590239965
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-539937",
      "id": "e6f012fa-f123-41f4-86ad-4a2e04ac1e6a",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="735"><div class="step-ref bg-step">735</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">5</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="736"><div class="step-ref bg-step">736</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="737"><div class="step-ref bg-step">737</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="738"><div class="step-ref bg-step">738</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="739"><div class="step-ref bg-step">739</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="740"><div class="step-ref bg-step">740</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="741"><div class="step-ref bg-step">741</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="742"><div class="step-ref bg-step">742</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="743"><div class="step-ref bg-step">743</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="744"><div class="step-ref bg-step">744</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="745"><div class="step-ref bg-step">745</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="746"><div class="step-ref bg-step">746</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="747"><div class="step-ref bg-step">747</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="748"><div class="step-ref bg-step">748</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="749"><div class="step-ref bg-step">749</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="750"><div class="step-ref bg-step">750</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="751"><div class="step-ref bg-step">751</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="752"><div class="step-ref bg-step">752</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="753"><div class="step-ref bg-step">753</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="754"><div class="step-ref bg-step">754</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">225</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="754.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">211</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="755"><div class="step-ref bg-step">755</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="756"><div class="step-ref bg-step">756</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="757"><div class="step-ref bg-step">757</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="758"><div class="step-ref bg-step">758</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="759"><div class="step-ref bg-step">759</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="760"><div class="step-ref bg-step">760</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="761"><div class="step-ref bg-step">761</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="762"><div class="step-ref bg-step">762</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="763"><div class="step-ref bg-step">763</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="764"><div class="step-ref bg-step">764</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">21</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="765"><div class="step-ref bg-step">765</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="766"><div class="step-ref bg-step">766</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="766">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="767"><div class="step-ref bg-step">767</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="768"><div class="step-ref bg-step">768</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="769"><div class="step-ref bg-step">769</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="770"><div class="step-ref bg-step">770</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">167</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="771"><div class="step-ref bg-step">771</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="772"><div class="step-ref bg-step">772</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="773"><div class="step-ref bg-step">773</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="774"><div class="step-ref bg-step">774</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="775"><div class="step-ref bg-step">775</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="776"><div class="step-ref bg-step">776</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="777"><div class="step-ref bg-step">777</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="778"><div class="step-ref bg-step">778</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="779"><div class="step-ref bg-step">779</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="780"><div class="step-ref bg-step">780</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="781"><div class="step-ref bg-step">781</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="782"><div class="step-ref bg-step">782</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="783"><div class="step-ref bg-step">783</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="784"><div class="step-ref bg-step">784</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="785"><div class="step-ref bg-step">785</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[9:95]bg"><div class="step-container" id="786"><div class="step-ref bg-step">786</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">6</div></div><div class="step-row"><div class="step-container" id="787"><div class="step-ref passed">787</div><div class="step-cell passed">* def billId = commonConstants.invalidParameters.invalidValue</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling create pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="788"><div class="step-ref passed">788</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionError')</div></div><div class="time-cell passed">162</div></div><div class="step-row"><div class="step-container" id="788.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell passed">159</div></div><div class="step-row"><div class="step-container" id="789"><div class="step-ref passed">789</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="790"><div class="step-ref passed">790</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="791"><div class="step-ref passed">791</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="792"><div class="step-ref passed">792</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="793"><div class="step-ref passed">793</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="794"><div class="step-ref passed">794</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">155</div></div><div class="step-row"><div class="step-container" id="795"><div class="step-ref passed">795</div><div class="step-indent"> </div><div class="step-cell passed">Then status 400</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="796"><div class="step-ref passed">796</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="797"><div class="step-ref passed">797</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell passed">0</div></div></div><div class="scenario"><div class="scenario-heading" id="[10:102]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">negative</a><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">PGCreate_DupicatePay_11</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a></div><span class="scenario-keyword">Scenario: [10:102]</span><span class="scenario-name">Verify creating a payment transaction with a bill id for which payment is already done </span></div><div class="scenario-time passed">ms: 1062</div></div><div class="step-row"><div class="step-container" id="[10:102]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="798"><div class="step-ref bg-step">798</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">245</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="798.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">213</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="799"><div class="step-ref bg-step">799</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">4</div></div><div class="preformatted" data-parent="799">15:40:40.258 karate.env:  
15:40:40.258 locale: en_IN 
15:40:40.259 tenantId: pb.amritsar</div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="800"><div class="step-ref bg-step">800</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="801"><div class="step-ref bg-step">801</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="802"><div class="step-ref bg-step">802</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="803"><div class="step-ref bg-step">803</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="804"><div class="step-ref bg-step">804</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="805"><div class="step-ref bg-step">805</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="806"><div class="step-ref bg-step">806</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="807"><div class="step-ref bg-step">807</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="808"><div class="step-ref bg-step">808</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="809"><div class="step-ref bg-step">809</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="810"><div class="step-ref bg-step">810</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="811"><div class="step-ref bg-step">811</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="812"><div class="step-ref bg-step">812</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="813"><div class="step-ref bg-step">813</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">182</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="813.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">175</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="814"><div class="step-ref bg-step">814</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="815"><div class="step-ref bg-step">815</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="816"><div class="step-ref bg-step">816</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="817"><div class="step-ref bg-step">817</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">10</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="818"><div class="step-ref bg-step">818</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="819"><div class="step-ref bg-step">819</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">10</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="820"><div class="step-ref bg-step">820</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="821"><div class="step-ref bg-step">821</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="822"><div class="step-ref bg-step">822</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="823"><div class="step-ref bg-step">823</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">141</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="824"><div class="step-ref bg-step">824</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="825"><div class="step-ref bg-step">825</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="826"><div class="step-ref bg-step">826</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="827"><div class="step-ref bg-step">827</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="827">15:40:40.495 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590240309,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763040310,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "b5c5bd3f-4223-4399-b463-909b5e66b257",
          "taxHeadMasterCode": "PT_ADVANCE_CARRYFORWARD",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590240694,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590240694
          },
          "tenantId": "pb.amritsar",
          "id": "5def0328-7e88-4741-8951-6cf9fb6aa182",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590240694,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590240694
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-185640",
      "id": "b5c5bd3f-4223-4399-b463-909b5e66b257",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="828"><div class="step-ref bg-step">828</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="829"><div class="step-ref bg-step">829</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="830"><div class="step-ref bg-step">830</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="831"><div class="step-ref bg-step">831</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="832"><div class="step-ref bg-step">832</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="833"><div class="step-ref bg-step">833</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="834"><div class="step-ref bg-step">834</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="835"><div class="step-ref bg-step">835</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="836"><div class="step-ref bg-step">836</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="837"><div class="step-ref bg-step">837</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="838"><div class="step-ref bg-step">838</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="839"><div class="step-ref bg-step">839</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="840"><div class="step-ref bg-step">840</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="841"><div class="step-ref bg-step">841</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="842"><div class="step-ref bg-step">842</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="843"><div class="step-ref bg-step">843</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="844"><div class="step-ref bg-step">844</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="845"><div class="step-ref bg-step">845</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="846"><div class="step-ref bg-step">846</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="847"><div class="step-ref bg-step">847</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">179</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="847.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">168</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="848"><div class="step-ref bg-step">848</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="849"><div class="step-ref bg-step">849</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="850"><div class="step-ref bg-step">850</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="851"><div class="step-ref bg-step">851</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="852"><div class="step-ref bg-step">852</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="853"><div class="step-ref bg-step">853</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="854"><div class="step-ref bg-step">854</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="855"><div class="step-ref bg-step">855</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="856"><div class="step-ref bg-step">856</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="857"><div class="step-ref bg-step">857</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">6</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="858"><div class="step-ref bg-step">858</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="859"><div class="step-ref bg-step">859</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="859">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="860"><div class="step-ref bg-step">860</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="861"><div class="step-ref bg-step">861</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="862"><div class="step-ref bg-step">862</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="863"><div class="step-ref bg-step">863</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">142</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="864"><div class="step-ref bg-step">864</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="865"><div class="step-ref bg-step">865</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="866"><div class="step-ref bg-step">866</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="867"><div class="step-ref bg-step">867</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="868"><div class="step-ref bg-step">868</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="869"><div class="step-ref bg-step">869</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="870"><div class="step-ref bg-step">870</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="871"><div class="step-ref bg-step">871</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="872"><div class="step-ref bg-step">872</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="873"><div class="step-ref bg-step">873</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="874"><div class="step-ref bg-step">874</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="875"><div class="step-ref bg-step">875</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="876"><div class="step-ref bg-step">876</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="877"><div class="step-ref bg-step">877</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="878"><div class="step-ref bg-step">878</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[10:102]bg"><div class="step-container" id="879"><div class="step-ref bg-step">879</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">6</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling create pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="880"><div class="step-ref passed">880</div><div class="step-cell passed">* call read('../../business-services/pretest/collectionServicesPretest.feature@createPayment')</div></div><div class="time-cell passed">443</div></div><div class="step-row"><div class="step-container" id="880.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/collectionServicesPretest.feature</div></div><div class="time-cell passed">426</div></div><div class="step-row"><div class="step-container" id="881"><div class="step-ref passed">881</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="882"><div class="step-ref passed">882</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionServicesConstants = read('../../business-services/constants/collection-services.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row"><div class="step-container" id="883"><div class="step-ref passed">883</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="884"><div class="step-ref passed">884</div><div class="step-indent"> </div><div class="step-cell passed">* def tenantId = tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="885"><div class="step-ref passed">885</div><div class="step-indent"> </div><div class="step-cell passed">* def paymentMode = collectionServicesConstants.parameters.paymentMode</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="886"><div class="step-ref passed">886</div><div class="step-indent"> </div><div class="step-cell passed">* def paidBy = 'Payer ' + randomString(10)</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="887"><div class="step-ref passed">887</div><div class="step-indent"> </div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="888"><div class="step-ref passed">888</div><div class="step-indent"> </div><div class="step-cell passed">* def payerName = 'Payer ' + randomString(10)</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="889"><div class="step-ref passed">889</div><div class="step-indent"> </div><div class="step-cell passed">* def totalDue = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="890"><div class="step-ref passed">890</div><div class="step-indent"> </div><div class="step-cell passed">* def transactionNumber = collectionServicesConstants.parameters.transactionNumber</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="891"><div class="step-ref passed">891</div><div class="step-indent"> </div><div class="step-cell passed">* def instrumentNumber = collectionServicesConstants.parameters.instrumentNumber</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="892"><div class="step-ref passed">892</div><div class="step-indent"> </div><div class="step-cell passed">* def paymentModeForCard = collectionServicesConstants.parameters.paymentMode2</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="893"><div class="step-ref passed">893</div><div class="step-indent"> </div><div class="step-cell passed">* def paymentModeForCheque = collectionServicesConstants.parameters.paymentModeForCheque</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="894"><div class="step-ref passed">894</div><div class="step-indent"> </div><div class="step-cell passed">* def transactionNumberForCheque = collectionServicesConstants.parameters.transactionNumberForCheque</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="895"><div class="step-ref passed">895</div><div class="step-indent"> </div><div class="step-cell passed">* def instrumentNumberForCheque = collectionServicesConstants.parameters.instrumentNumberForCheque</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="896"><div class="step-ref passed">896</div><div class="step-indent"> </div><div class="step-cell passed">* def instrumentDate = getPastEpochDate(1)</div></div><div class="time-cell passed">4</div></div><div class="step-row"><div class="step-container" id="897"><div class="step-ref passed">897</div><div class="step-indent"> </div><div class="step-cell passed">* def ifscCode = collectionServicesConstants.parameters.ifscCode</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="898"><div class="step-ref passed">898</div><div class="step-indent"> </div><div class="step-cell passed">* def invalidBillId = generateUUID()</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="899"><div class="step-ref passed">899</div><div class="step-indent"> </div><div class="step-cell passed">* def invalidBillId = generateUUID()</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="900"><div class="step-ref passed">900</div><div class="step-indent"> </div><div class="step-cell passed">* def createPaymentRequest = read('../../business-services/requestPayload/collection-services/create.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row"><div class="step-container" id="901"><div class="step-ref passed">901</div><div class="step-indent"> </div><div class="step-cell passed">* def workflowRequest = read('../../business-services/requestPayload/collection-services/workflow.json')</div></div><div class="time-cell passed">6</div></div><div class="step-row"><div class="step-container" id="902"><div class="step-ref passed">902</div><div class="step-indent"> </div><div class="step-cell passed">* def searchPaymentRequest = read('../../business-services/requestPayload/collection-services/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="903"><div class="step-ref passed">903</div><div class="step-indent"> </div><div class="step-cell passed">* def searchPTreceiptcount = read('../../business-services/requestPayload/collection-services/receiptcount.json')</div></div><div class="time-cell passed">3</div></div><div class="step-row"><div class="step-container" id="904"><div class="step-ref passed">904</div><div class="step-indent"> </div><div class="step-cell passed">* def createPaymentRequestForCheque = read('../../business-services/requestPayload/collection-services/createPaymentWithCheque.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row"><div class="step-container" id="905"><div class="step-ref passed">905</div><div class="step-indent"> </div><div class="step-cell passed">* def eChallanPaymentcount = read('../../business-services/requestPayload/collection-services/echallancount.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="906"><div class="step-ref passed">906</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="907"><div class="step-ref passed">907</div><div class="step-indent"> </div><div class="step-cell passed">* def invalidBillId = 'invalid_'+randomNumber(4)</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="908"><div class="step-ref passed">908</div><div class="step-indent"> </div><div class="step-cell passed">* def invalidBusinessId = 'PT'+randomNumber(4)</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="909"><div class="step-ref passed">909</div><div class="step-indent"> </div><div class="step-cell passed">* def invalidPaymentMode = randomString(4)</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="910"><div class="step-ref passed">910</div><div class="step-indent"> </div><div class="step-cell passed">* def invalidTenantId = randomString(5)</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="911"><div class="step-ref passed">911</div><div class="step-indent"> </div><div class="step-cell passed">* def negativeTotalAmount = '-'+randomNumber(4)</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="912"><div class="step-ref passed">912</div><div class="step-indent"> </div><div class="step-cell passed">Given url payment</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="913"><div class="step-ref passed">913</div><div class="step-indent"> </div><div class="step-cell passed">And request createPaymentRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># * print createPaymentRequest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="914"><div class="step-ref passed">914</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">361</div></div><div class="step-row"><div class="step-container" id="915"><div class="step-ref passed">915</div><div class="step-indent"> </div><div class="step-cell passed">Then status 200</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="916"><div class="step-ref passed">916</div><div class="step-indent"> </div><div class="step-cell passed">And def collectionServicesResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="917"><div class="step-ref passed">917</div><div class="step-indent"> </div><div class="step-cell passed">And def collectionServicesResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="918"><div class="step-ref passed">918</div><div class="step-indent"> </div><div class="step-cell passed">And def Payments = collectionServicesResponseBody.Payments</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling create pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="919"><div class="step-ref passed">919</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionError')</div></div><div class="time-cell passed">176</div></div><div class="step-row"><div class="step-container" id="919.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell passed">170</div></div><div class="step-row"><div class="step-container" id="920"><div class="step-ref passed">920</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="921"><div class="step-ref passed">921</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">7</div></div><div class="step-row"><div class="step-container" id="922"><div class="step-ref passed">922</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row"><div class="step-container" id="923"><div class="step-ref passed">923</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="924"><div class="step-ref passed">924</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="925"><div class="step-ref passed">925</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">153</div></div><div class="step-row"><div class="step-container" id="926"><div class="step-ref passed">926</div><div class="step-indent"> </div><div class="step-cell passed">Then status 400</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="927"><div class="step-ref passed">927</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="928"><div class="step-ref passed">928</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell passed">0</div></div></div><div class="scenario"><div class="scenario-heading" id="[11:110]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">PG_Update_01</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">positive</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a></div><span class="scenario-keyword">Scenario: [11:110]</span><span class="scenario-name">Update a payment transaction </span></div><div class="scenario-time passed">ms: 1597</div></div><div class="step-row"><div class="step-container" id="[11:110]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="929"><div class="step-ref bg-step">929</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">391</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="929.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">366</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="930"><div class="step-ref bg-step">930</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">6</div></div><div class="preformatted" data-parent="930">15:40:41.389 karate.env:  
15:40:41.389 locale: en_IN 
15:40:41.390 tenantId: pb.amritsar</div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="931"><div class="step-ref bg-step">931</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="932"><div class="step-ref bg-step">932</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="933"><div class="step-ref bg-step">933</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="934"><div class="step-ref bg-step">934</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="935"><div class="step-ref bg-step">935</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="936"><div class="step-ref bg-step">936</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="937"><div class="step-ref bg-step">937</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="938"><div class="step-ref bg-step">938</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="939"><div class="step-ref bg-step">939</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="940"><div class="step-ref bg-step">940</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="941"><div class="step-ref bg-step">941</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="942"><div class="step-ref bg-step">942</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="943"><div class="step-ref bg-step">943</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="944"><div class="step-ref bg-step">944</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">326</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="944.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">319</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="945"><div class="step-ref bg-step">945</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="946"><div class="step-ref bg-step">946</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="947"><div class="step-ref bg-step">947</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="948"><div class="step-ref bg-step">948</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">138</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="949"><div class="step-ref bg-step">949</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="950"><div class="step-ref bg-step">950</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="951"><div class="step-ref bg-step">951</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="952"><div class="step-ref bg-step">952</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="953"><div class="step-ref bg-step">953</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="954"><div class="step-ref bg-step">954</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">160</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="955"><div class="step-ref bg-step">955</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="956"><div class="step-ref bg-step">956</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="957"><div class="step-ref bg-step">957</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="958"><div class="step-ref bg-step">958</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="958">15:40:41.770 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590241437,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763041441,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "399846a4-e3b8-4dfd-ae00-bcfa04825b3c",
          "taxHeadMasterCode": "PT_DECIMAL_CEILING_CREDIT",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590241962,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590241962
          },
          "tenantId": "pb.amritsar",
          "id": "40af113c-a84d-4697-8aa6-ec4ae92d02bb",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590241962,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590241962
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-267569",
      "id": "399846a4-e3b8-4dfd-ae00-bcfa04825b3c",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="959"><div class="step-ref bg-step">959</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="960"><div class="step-ref bg-step">960</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="961"><div class="step-ref bg-step">961</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="962"><div class="step-ref bg-step">962</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="963"><div class="step-ref bg-step">963</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="964"><div class="step-ref bg-step">964</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="965"><div class="step-ref bg-step">965</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="966"><div class="step-ref bg-step">966</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="967"><div class="step-ref bg-step">967</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="968"><div class="step-ref bg-step">968</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="969"><div class="step-ref bg-step">969</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="970"><div class="step-ref bg-step">970</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="971"><div class="step-ref bg-step">971</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="972"><div class="step-ref bg-step">972</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="973"><div class="step-ref bg-step">973</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="974"><div class="step-ref bg-step">974</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="975"><div class="step-ref bg-step">975</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="976"><div class="step-ref bg-step">976</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="977"><div class="step-ref bg-step">977</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="978"><div class="step-ref bg-step">978</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">184</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="978.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">174</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="979"><div class="step-ref bg-step">979</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">5</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="980"><div class="step-ref bg-step">980</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">5</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="981"><div class="step-ref bg-step">981</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="982"><div class="step-ref bg-step">982</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="983"><div class="step-ref bg-step">983</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="984"><div class="step-ref bg-step">984</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="985"><div class="step-ref bg-step">985</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="986"><div class="step-ref bg-step">986</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="987"><div class="step-ref bg-step">987</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="988"><div class="step-ref bg-step">988</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="989"><div class="step-ref bg-step">989</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="990"><div class="step-ref bg-step">990</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="990">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="991"><div class="step-ref bg-step">991</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="992"><div class="step-ref bg-step">992</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="993"><div class="step-ref bg-step">993</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="994"><div class="step-ref bg-step">994</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">146</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="995"><div class="step-ref bg-step">995</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="996"><div class="step-ref bg-step">996</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="997"><div class="step-ref bg-step">997</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="998"><div class="step-ref bg-step">998</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="999"><div class="step-ref bg-step">999</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="1000"><div class="step-ref bg-step">1000</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="1001"><div class="step-ref bg-step">1001</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="1002"><div class="step-ref bg-step">1002</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="1003"><div class="step-ref bg-step">1003</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="1004"><div class="step-ref bg-step">1004</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="1005"><div class="step-ref bg-step">1005</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="1006"><div class="step-ref bg-step">1006</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="1007"><div class="step-ref bg-step">1007</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="1008"><div class="step-ref bg-step">1008</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="1009"><div class="step-ref bg-step">1009</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[11:110]bg"><div class="step-container" id="1010"><div class="step-ref bg-step">1010</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">7</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling update pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1011"><div class="step-ref passed">1011</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceUpdate.feature@updatePgTransactionSuccessfully')</div></div><div class="time-cell passed">999</div></div><div class="step-row"><div class="step-container" id="1011.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceUpdate.feature</div></div><div class="time-cell passed">993</div></div><div class="step-row"><div class="step-container" id="1012"><div class="step-ref passed">1012</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1013"><div class="step-ref passed">1013</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesUpdatePayload = read('../../core-services/requestPayload/pg-service/pgServicesUpdate.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1014"><div class="step-ref passed">1014</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionSuccessfully')</div></div><div class="time-cell passed">517</div></div><div class="step-row"><div class="step-container" id="1014.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell passed">510</div></div><div class="step-row"><div class="step-container" id="1015"><div class="step-ref passed">1015</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1016"><div class="step-ref passed">1016</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1017"><div class="step-ref passed">1017</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1018"><div class="step-ref passed">1018</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1019"><div class="step-ref passed">1019</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1020"><div class="step-ref passed">1020</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">505</div></div><div class="step-row"><div class="step-container" id="1021"><div class="step-ref passed">1021</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 200</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1022"><div class="step-ref passed">1022</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1023"><div class="step-ref passed">1023</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1024"><div class="step-ref passed">1024</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def txnId = pgServicesCreateResponseBody.Transaction.txnId</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1025"><div class="step-ref passed">1025</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1026"><div class="step-ref passed">1026</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesUpdateParam =</div></div><div class="time-cell passed">1</div></div><div class="preformatted" data-parent="1026">{
 transactionId: '#(txnId)'
}</div><div class="step-row"><div class="step-container" id="1027"><div class="step-ref passed">1027</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServicesUpdate</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1028"><div class="step-ref passed">1028</div><div class="step-indent"> </div><div class="step-cell passed">And params pgServicesUpdateParam</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1029"><div class="step-ref passed">1029</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesUpdatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1030"><div class="step-ref passed">1030</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">471</div></div><div class="step-row"><div class="step-container" id="1031"><div class="step-ref passed">1031</div><div class="step-indent"> </div><div class="step-cell passed">Then status 200</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1032"><div class="step-ref passed">1032</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesUpdateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1033"><div class="step-ref passed">1033</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesUpdateResponseBody = response</div></div><div class="time-cell passed">0</div></div></div><div class="scenario"><div class="scenario-heading" id="[12:116]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">negative</a><a class="badge badge-primary" href="karate-tags.html">PGUpdate_InvalidTxnId_02</a><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a></div><span class="scenario-keyword">Scenario: [12:116]</span><span class="scenario-name">Verify updating a payment transaction with invalid/non existent value for "transaction id" in the request body </span></div><div class="scenario-time passed">ms: 612</div></div><div class="step-row"><div class="step-container" id="[12:116]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1034"><div class="step-ref bg-step">1034</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">290</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1034.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">256</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1035"><div class="step-ref bg-step">1035</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">3</div></div><div class="preformatted" data-parent="1035">15:40:43.059 karate.env:  
15:40:43.059 locale: en_IN 
15:40:43.059 tenantId: pb.amritsar</div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1036"><div class="step-ref bg-step">1036</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1037"><div class="step-ref bg-step">1037</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1038"><div class="step-ref bg-step">1038</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1039"><div class="step-ref bg-step">1039</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1040"><div class="step-ref bg-step">1040</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1041"><div class="step-ref bg-step">1041</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1042"><div class="step-ref bg-step">1042</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1043"><div class="step-ref bg-step">1043</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1044"><div class="step-ref bg-step">1044</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1045"><div class="step-ref bg-step">1045</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1046"><div class="step-ref bg-step">1046</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1047"><div class="step-ref bg-step">1047</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1048"><div class="step-ref bg-step">1048</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1049"><div class="step-ref bg-step">1049</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">228</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1049.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">217</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1050"><div class="step-ref bg-step">1050</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1051"><div class="step-ref bg-step">1051</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1052"><div class="step-ref bg-step">1052</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1053"><div class="step-ref bg-step">1053</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">17</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1054"><div class="step-ref bg-step">1054</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1055"><div class="step-ref bg-step">1055</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">11</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1056"><div class="step-ref bg-step">1056</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1057"><div class="step-ref bg-step">1057</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1058"><div class="step-ref bg-step">1058</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1059"><div class="step-ref bg-step">1059</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">173</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1060"><div class="step-ref bg-step">1060</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1061"><div class="step-ref bg-step">1061</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1062"><div class="step-ref bg-step">1062</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1063"><div class="step-ref bg-step">1063</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="1063">15:40:43.342 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590243109,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763043111,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "991add2f-2c09-4d46-800b-79621ed5f9f5",
          "taxHeadMasterCode": "PT_DECIMAL_CEILING_DEBIT",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590243537,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590243537
          },
          "tenantId": "pb.amritsar",
          "id": "aa28adf0-556a-4fa9-94bd-78b40651b2e2",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590243537,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590243537
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-83170",
      "id": "991add2f-2c09-4d46-800b-79621ed5f9f5",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1064"><div class="step-ref bg-step">1064</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1065"><div class="step-ref bg-step">1065</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1066"><div class="step-ref bg-step">1066</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1067"><div class="step-ref bg-step">1067</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1068"><div class="step-ref bg-step">1068</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1069"><div class="step-ref bg-step">1069</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1070"><div class="step-ref bg-step">1070</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1071"><div class="step-ref bg-step">1071</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1072"><div class="step-ref bg-step">1072</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1073"><div class="step-ref bg-step">1073</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1074"><div class="step-ref bg-step">1074</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1075"><div class="step-ref bg-step">1075</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1076"><div class="step-ref bg-step">1076</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1077"><div class="step-ref bg-step">1077</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1078"><div class="step-ref bg-step">1078</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1079"><div class="step-ref bg-step">1079</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1080"><div class="step-ref bg-step">1080</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1081"><div class="step-ref bg-step">1081</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1082"><div class="step-ref bg-step">1082</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1083"><div class="step-ref bg-step">1083</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">173</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1083.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">165</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1084"><div class="step-ref bg-step">1084</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1085"><div class="step-ref bg-step">1085</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1086"><div class="step-ref bg-step">1086</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1087"><div class="step-ref bg-step">1087</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1088"><div class="step-ref bg-step">1088</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1089"><div class="step-ref bg-step">1089</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1090"><div class="step-ref bg-step">1090</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1091"><div class="step-ref bg-step">1091</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1092"><div class="step-ref bg-step">1092</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1093"><div class="step-ref bg-step">1093</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">6</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1094"><div class="step-ref bg-step">1094</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1095"><div class="step-ref bg-step">1095</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">1</div></div><div class="preformatted" data-parent="1095">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1096"><div class="step-ref bg-step">1096</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1097"><div class="step-ref bg-step">1097</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1098"><div class="step-ref bg-step">1098</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1099"><div class="step-ref bg-step">1099</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">140</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1100"><div class="step-ref bg-step">1100</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1101"><div class="step-ref bg-step">1101</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1102"><div class="step-ref bg-step">1102</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1103"><div class="step-ref bg-step">1103</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1104"><div class="step-ref bg-step">1104</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1105"><div class="step-ref bg-step">1105</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1106"><div class="step-ref bg-step">1106</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1107"><div class="step-ref bg-step">1107</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1108"><div class="step-ref bg-step">1108</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1109"><div class="step-ref bg-step">1109</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1110"><div class="step-ref bg-step">1110</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1111"><div class="step-ref bg-step">1111</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1112"><div class="step-ref bg-step">1112</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1113"><div class="step-ref bg-step">1113</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1114"><div class="step-ref bg-step">1114</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[12:116]bg"><div class="step-container" id="1115"><div class="step-ref bg-step">1115</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">6</div></div><div class="step-row"><div class="step-container" id="1116"><div class="step-ref passed">1116</div><div class="step-cell passed">* def transactionId = ranString(10)</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling update pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1117"><div class="step-ref passed">1117</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceUpdate.feature@invalidTransactionIdError')</div></div><div class="time-cell passed">126</div></div><div class="step-row"><div class="step-container" id="1117.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceUpdate.feature</div></div><div class="time-cell passed">121</div></div><div class="step-row"><div class="step-container" id="1118"><div class="step-ref passed">1118</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1119"><div class="step-ref passed">1119</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesUpdatePayload = read('../../core-services/requestPayload/pg-service/pgServicesUpdate.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1120"><div class="step-ref passed">1120</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1121"><div class="step-ref passed">1121</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesUpdateParam =</div></div><div class="time-cell passed">1</div></div><div class="preformatted" data-parent="1121">{
 transactionId: '#(txnId)'
}</div><div class="step-row"><div class="step-container" id="1122"><div class="step-ref passed">1122</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServicesUpdate</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1123"><div class="step-ref passed">1123</div><div class="step-indent"> </div><div class="step-cell passed">And params pgServicesUpdateParam</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1124"><div class="step-ref passed">1124</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesUpdatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1125"><div class="step-ref passed">1125</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">115</div></div><div class="step-row"><div class="step-container" id="1126"><div class="step-ref passed">1126</div><div class="step-indent"> </div><div class="step-cell passed">Then status 400</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1127"><div class="step-ref passed">1127</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesUpdateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1128"><div class="step-ref passed">1128</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesUpdateResponseBody = response</div></div><div class="time-cell passed">0</div></div></div><div class="scenario"><div class="scenario-heading" id="[13:123]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">negative</a><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a><a class="badge badge-primary" href="karate-tags.html">PGUpdate_NoTxnId_03</a></div><span class="scenario-keyword">Scenario: [13:123]</span><span class="scenario-name">Verify updating a payment transaction by not passing transaction id </span></div><div class="scenario-time passed">ms: 627</div></div><div class="step-row"><div class="step-container" id="[13:123]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1129"><div class="step-ref bg-step">1129</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">275</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1129.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">245</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1130"><div class="step-ref bg-step">1130</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">4</div></div><div class="preformatted" data-parent="1130">15:40:43.742 karate.env:  
15:40:43.742 locale: en_IN 
15:40:43.743 tenantId: pb.amritsar</div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1131"><div class="step-ref bg-step">1131</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1132"><div class="step-ref bg-step">1132</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1133"><div class="step-ref bg-step">1133</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">5</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1134"><div class="step-ref bg-step">1134</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1135"><div class="step-ref bg-step">1135</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1136"><div class="step-ref bg-step">1136</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1137"><div class="step-ref bg-step">1137</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1138"><div class="step-ref bg-step">1138</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1139"><div class="step-ref bg-step">1139</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1140"><div class="step-ref bg-step">1140</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1141"><div class="step-ref bg-step">1141</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1142"><div class="step-ref bg-step">1142</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1143"><div class="step-ref bg-step">1143</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1144"><div class="step-ref bg-step">1144</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">210</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1144.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">196</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1145"><div class="step-ref bg-step">1145</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">9</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1146"><div class="step-ref bg-step">1146</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1147"><div class="step-ref bg-step">1147</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1148"><div class="step-ref bg-step">1148</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">13</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1149"><div class="step-ref bg-step">1149</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1150"><div class="step-ref bg-step">1150</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">9</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1151"><div class="step-ref bg-step">1151</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1152"><div class="step-ref bg-step">1152</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1153"><div class="step-ref bg-step">1153</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1154"><div class="step-ref bg-step">1154</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">151</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1155"><div class="step-ref bg-step">1155</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1156"><div class="step-ref bg-step">1156</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1157"><div class="step-ref bg-step">1157</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1158"><div class="step-ref bg-step">1158</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="1158">15:40:44.009 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590243792,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763043794,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "cdfee091-2520-4c31-81a2-f541cdc489db",
          "taxHeadMasterCode": "PT_TAX",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590244202,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590244202
          },
          "tenantId": "pb.amritsar",
          "id": "5fc15bbf-3b5a-4475-9177-be7f3d37ca2f",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590244202,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590244202
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-335089",
      "id": "cdfee091-2520-4c31-81a2-f541cdc489db",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1159"><div class="step-ref bg-step">1159</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1160"><div class="step-ref bg-step">1160</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1161"><div class="step-ref bg-step">1161</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1162"><div class="step-ref bg-step">1162</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1163"><div class="step-ref bg-step">1163</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1164"><div class="step-ref bg-step">1164</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1165"><div class="step-ref bg-step">1165</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1166"><div class="step-ref bg-step">1166</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1167"><div class="step-ref bg-step">1167</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1168"><div class="step-ref bg-step">1168</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1169"><div class="step-ref bg-step">1169</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1170"><div class="step-ref bg-step">1170</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1171"><div class="step-ref bg-step">1171</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1172"><div class="step-ref bg-step">1172</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1173"><div class="step-ref bg-step">1173</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1174"><div class="step-ref bg-step">1174</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1175"><div class="step-ref bg-step">1175</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1176"><div class="step-ref bg-step">1176</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1177"><div class="step-ref bg-step">1177</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1178"><div class="step-ref bg-step">1178</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">193</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1178.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">186</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1179"><div class="step-ref bg-step">1179</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1180"><div class="step-ref bg-step">1180</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1181"><div class="step-ref bg-step">1181</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1182"><div class="step-ref bg-step">1182</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1183"><div class="step-ref bg-step">1183</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1184"><div class="step-ref bg-step">1184</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1185"><div class="step-ref bg-step">1185</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1186"><div class="step-ref bg-step">1186</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1187"><div class="step-ref bg-step">1187</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1188"><div class="step-ref bg-step">1188</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">5</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1189"><div class="step-ref bg-step">1189</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1190"><div class="step-ref bg-step">1190</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="1190">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1191"><div class="step-ref bg-step">1191</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1192"><div class="step-ref bg-step">1192</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1193"><div class="step-ref bg-step">1193</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1194"><div class="step-ref bg-step">1194</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">159</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1195"><div class="step-ref bg-step">1195</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1196"><div class="step-ref bg-step">1196</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1197"><div class="step-ref bg-step">1197</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1198"><div class="step-ref bg-step">1198</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1199"><div class="step-ref bg-step">1199</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1200"><div class="step-ref bg-step">1200</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1201"><div class="step-ref bg-step">1201</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1202"><div class="step-ref bg-step">1202</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1203"><div class="step-ref bg-step">1203</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1204"><div class="step-ref bg-step">1204</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1205"><div class="step-ref bg-step">1205</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1206"><div class="step-ref bg-step">1206</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1207"><div class="step-ref bg-step">1207</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1208"><div class="step-ref bg-step">1208</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1209"><div class="step-ref bg-step">1209</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[13:123]bg"><div class="step-container" id="1210"><div class="step-ref bg-step">1210</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">6</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling update pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1211"><div class="step-ref passed">1211</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceUpdate.feature@withouttransactionidpgservicefail')</div></div><div class="time-cell passed">139</div></div><div class="step-row"><div class="step-container" id="1211.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceUpdate.feature</div></div><div class="time-cell passed">134</div></div><div class="step-row"><div class="step-container" id="1212"><div class="step-ref passed">1212</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1213"><div class="step-ref passed">1213</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesUpdatePayload = read('../../core-services/requestPayload/pg-service/pgServicesUpdate.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1214"><div class="step-ref passed">1214</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1215"><div class="step-ref passed">1215</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServicesUpdate</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1216"><div class="step-ref passed">1216</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesUpdatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1217"><div class="step-ref passed">1217</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">129</div></div><div class="step-row"><div class="step-container" id="1218"><div class="step-ref passed">1218</div><div class="step-indent"> </div><div class="step-cell passed">Then status 400</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1219"><div class="step-ref passed">1219</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesUpdateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1220"><div class="step-ref passed">1220</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesUpdateResponseBody = response</div></div><div class="time-cell passed">0</div></div></div><div class="scenario"><div class="scenario-heading" id="[14:129]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">PGUpdate_BillVal_05</a><a class="badge badge-primary" href="karate-tags.html">negative</a><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a></div><span class="scenario-keyword">Scenario: [14:129]</span><span class="scenario-name">Verify updating by passing a transaction id which has expired bill and bill which is already paid </span></div><div class="scenario-time passed">ms: 1313</div></div><div class="step-row"><div class="step-container" id="[14:129]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1221"><div class="step-ref bg-step">1221</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">288</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1221.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">243</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1222"><div class="step-ref bg-step">1222</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="preformatted" data-parent="1222">15:40:44.558 karate.env:  
15:40:44.558 locale: en_IN 
15:40:44.559 tenantId: pb.amritsar</div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1223"><div class="step-ref bg-step">1223</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1224"><div class="step-ref bg-step">1224</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1225"><div class="step-ref bg-step">1225</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1226"><div class="step-ref bg-step">1226</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1227"><div class="step-ref bg-step">1227</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1228"><div class="step-ref bg-step">1228</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1229"><div class="step-ref bg-step">1229</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1230"><div class="step-ref bg-step">1230</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1231"><div class="step-ref bg-step">1231</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1232"><div class="step-ref bg-step">1232</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1233"><div class="step-ref bg-step">1233</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1234"><div class="step-ref bg-step">1234</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1235"><div class="step-ref bg-step">1235</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1236"><div class="step-ref bg-step">1236</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">215</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1236.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">208</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1237"><div class="step-ref bg-step">1237</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1238"><div class="step-ref bg-step">1238</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1239"><div class="step-ref bg-step">1239</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1240"><div class="step-ref bg-step">1240</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1241"><div class="step-ref bg-step">1241</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1242"><div class="step-ref bg-step">1242</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">10</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1243"><div class="step-ref bg-step">1243</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1244"><div class="step-ref bg-step">1244</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1245"><div class="step-ref bg-step">1245</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1246"><div class="step-ref bg-step">1246</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">176</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1247"><div class="step-ref bg-step">1247</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1248"><div class="step-ref bg-step">1248</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1249"><div class="step-ref bg-step">1249</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1250"><div class="step-ref bg-step">1250</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="1250">15:40:44.842 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590244622,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763044627,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "c7a9310a-5c72-42c0-b748-6375ae282046",
          "taxHeadMasterCode": "PT_DECIMAL_CEILING_CREDIT",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590245024,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590245024
          },
          "tenantId": "pb.amritsar",
          "id": "3c741539-970e-4197-a9f4-0628894ccf08",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590245024,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590245024
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-160311",
      "id": "c7a9310a-5c72-42c0-b748-6375ae282046",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1251"><div class="step-ref bg-step">1251</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1252"><div class="step-ref bg-step">1252</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1253"><div class="step-ref bg-step">1253</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1254"><div class="step-ref bg-step">1254</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1255"><div class="step-ref bg-step">1255</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1256"><div class="step-ref bg-step">1256</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1257"><div class="step-ref bg-step">1257</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1258"><div class="step-ref bg-step">1258</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1259"><div class="step-ref bg-step">1259</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1260"><div class="step-ref bg-step">1260</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1261"><div class="step-ref bg-step">1261</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1262"><div class="step-ref bg-step">1262</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1263"><div class="step-ref bg-step">1263</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1264"><div class="step-ref bg-step">1264</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1265"><div class="step-ref bg-step">1265</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1266"><div class="step-ref bg-step">1266</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1267"><div class="step-ref bg-step">1267</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1268"><div class="step-ref bg-step">1268</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1269"><div class="step-ref bg-step">1269</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1270"><div class="step-ref bg-step">1270</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">185</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1270.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">177</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1271"><div class="step-ref bg-step">1271</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1272"><div class="step-ref bg-step">1272</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1273"><div class="step-ref bg-step">1273</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1274"><div class="step-ref bg-step">1274</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1275"><div class="step-ref bg-step">1275</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1276"><div class="step-ref bg-step">1276</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1277"><div class="step-ref bg-step">1277</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1278"><div class="step-ref bg-step">1278</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1279"><div class="step-ref bg-step">1279</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1280"><div class="step-ref bg-step">1280</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1281"><div class="step-ref bg-step">1281</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1282"><div class="step-ref bg-step">1282</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="1282">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1283"><div class="step-ref bg-step">1283</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1284"><div class="step-ref bg-step">1284</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1285"><div class="step-ref bg-step">1285</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1286"><div class="step-ref bg-step">1286</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">155</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1287"><div class="step-ref bg-step">1287</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1288"><div class="step-ref bg-step">1288</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1289"><div class="step-ref bg-step">1289</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1290"><div class="step-ref bg-step">1290</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1291"><div class="step-ref bg-step">1291</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1292"><div class="step-ref bg-step">1292</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1293"><div class="step-ref bg-step">1293</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1294"><div class="step-ref bg-step">1294</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1295"><div class="step-ref bg-step">1295</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1296"><div class="step-ref bg-step">1296</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1297"><div class="step-ref bg-step">1297</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1298"><div class="step-ref bg-step">1298</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1299"><div class="step-ref bg-step">1299</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1300"><div class="step-ref bg-step">1300</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1301"><div class="step-ref bg-step">1301</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[14:129]bg"><div class="step-container" id="1302"><div class="step-ref bg-step">1302</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">6</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling collection service create payment pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1303"><div class="step-ref passed">1303</div><div class="step-cell passed">* call read('../../business-services/pretest/collectionServicesPretest.feature@createPayment')</div></div><div class="time-cell passed">487</div></div><div class="step-row"><div class="step-container" id="1303.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/collectionServicesPretest.feature</div></div><div class="time-cell passed">469</div></div><div class="step-row"><div class="step-container" id="1304"><div class="step-ref passed">1304</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1305"><div class="step-ref passed">1305</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionServicesConstants = read('../../business-services/constants/collection-services.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1306"><div class="step-ref passed">1306</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1307"><div class="step-ref passed">1307</div><div class="step-indent"> </div><div class="step-cell passed">* def tenantId = tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1308"><div class="step-ref passed">1308</div><div class="step-indent"> </div><div class="step-cell passed">* def paymentMode = collectionServicesConstants.parameters.paymentMode</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1309"><div class="step-ref passed">1309</div><div class="step-indent"> </div><div class="step-cell passed">* def paidBy = 'Payer ' + randomString(10)</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1310"><div class="step-ref passed">1310</div><div class="step-indent"> </div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1311"><div class="step-ref passed">1311</div><div class="step-indent"> </div><div class="step-cell passed">* def payerName = 'Payer ' + randomString(10)</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1312"><div class="step-ref passed">1312</div><div class="step-indent"> </div><div class="step-cell passed">* def totalDue = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1313"><div class="step-ref passed">1313</div><div class="step-indent"> </div><div class="step-cell passed">* def transactionNumber = collectionServicesConstants.parameters.transactionNumber</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1314"><div class="step-ref passed">1314</div><div class="step-indent"> </div><div class="step-cell passed">* def instrumentNumber = collectionServicesConstants.parameters.instrumentNumber</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1315"><div class="step-ref passed">1315</div><div class="step-indent"> </div><div class="step-cell passed">* def paymentModeForCard = collectionServicesConstants.parameters.paymentMode2</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1316"><div class="step-ref passed">1316</div><div class="step-indent"> </div><div class="step-cell passed">* def paymentModeForCheque = collectionServicesConstants.parameters.paymentModeForCheque</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1317"><div class="step-ref passed">1317</div><div class="step-indent"> </div><div class="step-cell passed">* def transactionNumberForCheque = collectionServicesConstants.parameters.transactionNumberForCheque</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1318"><div class="step-ref passed">1318</div><div class="step-indent"> </div><div class="step-cell passed">* def instrumentNumberForCheque = collectionServicesConstants.parameters.instrumentNumberForCheque</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1319"><div class="step-ref passed">1319</div><div class="step-indent"> </div><div class="step-cell passed">* def instrumentDate = getPastEpochDate(1)</div></div><div class="time-cell passed">3</div></div><div class="step-row"><div class="step-container" id="1320"><div class="step-ref passed">1320</div><div class="step-indent"> </div><div class="step-cell passed">* def ifscCode = collectionServicesConstants.parameters.ifscCode</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1321"><div class="step-ref passed">1321</div><div class="step-indent"> </div><div class="step-cell passed">* def invalidBillId = generateUUID()</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1322"><div class="step-ref passed">1322</div><div class="step-indent"> </div><div class="step-cell passed">* def invalidBillId = generateUUID()</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1323"><div class="step-ref passed">1323</div><div class="step-indent"> </div><div class="step-cell passed">* def createPaymentRequest = read('../../business-services/requestPayload/collection-services/create.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row"><div class="step-container" id="1324"><div class="step-ref passed">1324</div><div class="step-indent"> </div><div class="step-cell passed">* def workflowRequest = read('../../business-services/requestPayload/collection-services/workflow.json')</div></div><div class="time-cell passed">5</div></div><div class="step-row"><div class="step-container" id="1325"><div class="step-ref passed">1325</div><div class="step-indent"> </div><div class="step-cell passed">* def searchPaymentRequest = read('../../business-services/requestPayload/collection-services/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1326"><div class="step-ref passed">1326</div><div class="step-indent"> </div><div class="step-cell passed">* def searchPTreceiptcount = read('../../business-services/requestPayload/collection-services/receiptcount.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1327"><div class="step-ref passed">1327</div><div class="step-indent"> </div><div class="step-cell passed">* def createPaymentRequestForCheque = read('../../business-services/requestPayload/collection-services/createPaymentWithCheque.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row"><div class="step-container" id="1328"><div class="step-ref passed">1328</div><div class="step-indent"> </div><div class="step-cell passed">* def eChallanPaymentcount = read('../../business-services/requestPayload/collection-services/echallancount.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1329"><div class="step-ref passed">1329</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1330"><div class="step-ref passed">1330</div><div class="step-indent"> </div><div class="step-cell passed">* def invalidBillId = 'invalid_'+randomNumber(4)</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1331"><div class="step-ref passed">1331</div><div class="step-indent"> </div><div class="step-cell passed">* def invalidBusinessId = 'PT'+randomNumber(4)</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1332"><div class="step-ref passed">1332</div><div class="step-indent"> </div><div class="step-cell passed">* def invalidPaymentMode = randomString(4)</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1333"><div class="step-ref passed">1333</div><div class="step-indent"> </div><div class="step-cell passed">* def invalidTenantId = randomString(5)</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1334"><div class="step-ref passed">1334</div><div class="step-indent"> </div><div class="step-cell passed">* def negativeTotalAmount = '-'+randomNumber(4)</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1335"><div class="step-ref passed">1335</div><div class="step-indent"> </div><div class="step-cell passed">Given url payment</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1336"><div class="step-ref passed">1336</div><div class="step-indent"> </div><div class="step-cell passed">And request createPaymentRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># * print createPaymentRequest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1337"><div class="step-ref passed">1337</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">411</div></div><div class="step-row"><div class="step-container" id="1338"><div class="step-ref passed">1338</div><div class="step-indent"> </div><div class="step-cell passed">Then status 200</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1339"><div class="step-ref passed">1339</div><div class="step-indent"> </div><div class="step-cell passed">And def collectionServicesResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1340"><div class="step-ref passed">1340</div><div class="step-indent"> </div><div class="step-cell passed">And def collectionServicesResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1341"><div class="step-ref passed">1341</div><div class="step-indent"> </div><div class="step-cell passed">And def Payments = collectionServicesResponseBody.Payments</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1342"><div class="step-ref passed">1342</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceUpdate.feature@updatePgTransactionError')</div></div><div class="time-cell passed">331</div></div><div class="step-row"><div class="step-container" id="1342.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceUpdate.feature</div></div><div class="time-cell passed">321</div></div><div class="step-row"><div class="step-container" id="1343"><div class="step-ref passed">1343</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">10</div></div><div class="step-row"><div class="step-container" id="1344"><div class="step-ref passed">1344</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesUpdatePayload = read('../../core-services/requestPayload/pg-service/pgServicesUpdate.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1345"><div class="step-ref passed">1345</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionError')</div></div><div class="time-cell passed">174</div></div><div class="step-row"><div class="step-container" id="1345.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell passed">170</div></div><div class="step-row"><div class="step-container" id="1346"><div class="step-ref passed">1346</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1347"><div class="step-ref passed">1347</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1348"><div class="step-ref passed">1348</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">11</div></div><div class="step-row"><div class="step-container" id="1349"><div class="step-ref passed">1349</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1350"><div class="step-ref passed">1350</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1351"><div class="step-ref passed">1351</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">155</div></div><div class="step-row"><div class="step-container" id="1352"><div class="step-ref passed">1352</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 400</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1353"><div class="step-ref passed">1353</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1354"><div class="step-ref passed">1354</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1355"><div class="step-ref passed">1355</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1356"><div class="step-ref passed">1356</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesUpdateParam =</div></div><div class="time-cell passed">2</div></div><div class="preformatted" data-parent="1356">{
 transactionId: '#(txnId)'
}</div><div class="step-row"><div class="step-container" id="1357"><div class="step-ref passed">1357</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServicesUpdate</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1358"><div class="step-ref passed">1358</div><div class="step-indent"> </div><div class="step-cell passed">And params pgServicesUpdateParam</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1359"><div class="step-ref passed">1359</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesUpdatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1360"><div class="step-ref passed">1360</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">133</div></div><div class="step-row"><div class="step-container" id="1361"><div class="step-ref passed">1361</div><div class="step-indent"> </div><div class="step-cell passed">Then status 400</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1362"><div class="step-ref passed">1362</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesUpdateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1363"><div class="step-ref passed">1363</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesUpdateResponseBody = response</div></div><div class="time-cell passed">0</div></div></div><div class="scenario"><div class="scenario-heading" id="[15:136]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">negative</a><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a><a class="badge badge-primary" href="karate-tags.html">PGSearch_Txn_01</a></div><span class="scenario-keyword">Scenario: [15:136]</span><span class="scenario-name">Verify searching transaction details using txn id </span></div><div class="scenario-time passed">ms: 470</div></div><div class="step-row"><div class="step-container" id="[15:136]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1364"><div class="step-ref bg-step">1364</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">243</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1364.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">207</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1365"><div class="step-ref bg-step">1365</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="preformatted" data-parent="1365">15:40:45.941 karate.env:  
15:40:45.941 locale: en_IN 
15:40:45.941 tenantId: pb.amritsar</div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1366"><div class="step-ref bg-step">1366</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1367"><div class="step-ref bg-step">1367</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1368"><div class="step-ref bg-step">1368</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1369"><div class="step-ref bg-step">1369</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1370"><div class="step-ref bg-step">1370</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1371"><div class="step-ref bg-step">1371</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1372"><div class="step-ref bg-step">1372</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1373"><div class="step-ref bg-step">1373</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1374"><div class="step-ref bg-step">1374</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1375"><div class="step-ref bg-step">1375</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">5</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1376"><div class="step-ref bg-step">1376</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1377"><div class="step-ref bg-step">1377</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1378"><div class="step-ref bg-step">1378</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1379"><div class="step-ref bg-step">1379</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">175</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1379.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">165</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1380"><div class="step-ref bg-step">1380</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1381"><div class="step-ref bg-step">1381</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1382"><div class="step-ref bg-step">1382</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1383"><div class="step-ref bg-step">1383</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">12</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1384"><div class="step-ref bg-step">1384</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1385"><div class="step-ref bg-step">1385</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1386"><div class="step-ref bg-step">1386</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1387"><div class="step-ref bg-step">1387</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1388"><div class="step-ref bg-step">1388</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1389"><div class="step-ref bg-step">1389</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">133</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1390"><div class="step-ref bg-step">1390</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1391"><div class="step-ref bg-step">1391</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1392"><div class="step-ref bg-step">1392</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1393"><div class="step-ref bg-step">1393</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="1393">15:40:46.175 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590245992,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763045996,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "f141b6f4-a4f1-48a2-a74a-5bfa94a1ba35",
          "taxHeadMasterCode": "PT_DECIMAL_CEILING_DEBIT",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590246379,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590246379
          },
          "tenantId": "pb.amritsar",
          "id": "335b66fd-ce58-4cff-b322-3d5968809098",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590246379,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590246379
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-301884",
      "id": "f141b6f4-a4f1-48a2-a74a-5bfa94a1ba35",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1394"><div class="step-ref bg-step">1394</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1395"><div class="step-ref bg-step">1395</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1396"><div class="step-ref bg-step">1396</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1397"><div class="step-ref bg-step">1397</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1398"><div class="step-ref bg-step">1398</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1399"><div class="step-ref bg-step">1399</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1400"><div class="step-ref bg-step">1400</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1401"><div class="step-ref bg-step">1401</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1402"><div class="step-ref bg-step">1402</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1403"><div class="step-ref bg-step">1403</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1404"><div class="step-ref bg-step">1404</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1405"><div class="step-ref bg-step">1405</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1406"><div class="step-ref bg-step">1406</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1407"><div class="step-ref bg-step">1407</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1408"><div class="step-ref bg-step">1408</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1409"><div class="step-ref bg-step">1409</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1410"><div class="step-ref bg-step">1410</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1411"><div class="step-ref bg-step">1411</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1412"><div class="step-ref bg-step">1412</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1413"><div class="step-ref bg-step">1413</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">200</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1413.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">192</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1414"><div class="step-ref bg-step">1414</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1415"><div class="step-ref bg-step">1415</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1416"><div class="step-ref bg-step">1416</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1417"><div class="step-ref bg-step">1417</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1418"><div class="step-ref bg-step">1418</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1419"><div class="step-ref bg-step">1419</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1420"><div class="step-ref bg-step">1420</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1421"><div class="step-ref bg-step">1421</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1422"><div class="step-ref bg-step">1422</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1423"><div class="step-ref bg-step">1423</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">6</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1424"><div class="step-ref bg-step">1424</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1425"><div class="step-ref bg-step">1425</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="1425">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1426"><div class="step-ref bg-step">1426</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1427"><div class="step-ref bg-step">1427</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1428"><div class="step-ref bg-step">1428</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1429"><div class="step-ref bg-step">1429</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">164</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1430"><div class="step-ref bg-step">1430</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1431"><div class="step-ref bg-step">1431</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1432"><div class="step-ref bg-step">1432</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1433"><div class="step-ref bg-step">1433</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1434"><div class="step-ref bg-step">1434</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1435"><div class="step-ref bg-step">1435</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1436"><div class="step-ref bg-step">1436</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1437"><div class="step-ref bg-step">1437</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1438"><div class="step-ref bg-step">1438</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1439"><div class="step-ref bg-step">1439</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1440"><div class="step-ref bg-step">1440</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1441"><div class="step-ref bg-step">1441</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1442"><div class="step-ref bg-step">1442</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1443"><div class="step-ref bg-step">1443</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1444"><div class="step-ref bg-step">1444</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[15:136]bg"><div class="step-container" id="1445"><div class="step-ref bg-step">1445</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">6</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling search pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1446"><div class="step-ref passed">1446</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceUpdate.feature@searchPgTransactionSuccessfully')</div></div><div class="time-cell passed">5</div></div></div><div class="scenario"><div class="scenario-heading" id="[16:142]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">negative</a><a class="badge badge-primary" href="karate-tags.html">PGSearch_InvalidTxn_02</a><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a></div><span class="scenario-keyword">Scenario: [16:142]</span><span class="scenario-name">Verify searching transaction details using null/ invalid/non existent  value for "transaction id" </span></div><div class="scenario-time passed">ms: 1229</div></div><div class="step-row"><div class="step-container" id="[16:142]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1447"><div class="step-ref bg-step">1447</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">333</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1447.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">218</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1448"><div class="step-ref bg-step">1448</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="preformatted" data-parent="1448">15:40:46.478 karate.env:  
15:40:46.478 locale: en_IN 
15:40:46.478 tenantId: pb.amritsar</div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1449"><div class="step-ref bg-step">1449</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1450"><div class="step-ref bg-step">1450</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1451"><div class="step-ref bg-step">1451</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1452"><div class="step-ref bg-step">1452</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1453"><div class="step-ref bg-step">1453</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1454"><div class="step-ref bg-step">1454</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1455"><div class="step-ref bg-step">1455</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1456"><div class="step-ref bg-step">1456</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1457"><div class="step-ref bg-step">1457</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1458"><div class="step-ref bg-step">1458</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1459"><div class="step-ref bg-step">1459</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1460"><div class="step-ref bg-step">1460</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1461"><div class="step-ref bg-step">1461</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1462"><div class="step-ref bg-step">1462</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">184</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1462.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">174</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1463"><div class="step-ref bg-step">1463</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1464"><div class="step-ref bg-step">1464</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1465"><div class="step-ref bg-step">1465</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1466"><div class="step-ref bg-step">1466</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1467"><div class="step-ref bg-step">1467</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1468"><div class="step-ref bg-step">1468</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">11</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1469"><div class="step-ref bg-step">1469</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1470"><div class="step-ref bg-step">1470</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1471"><div class="step-ref bg-step">1471</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1472"><div class="step-ref bg-step">1472</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">142</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1473"><div class="step-ref bg-step">1473</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1474"><div class="step-ref bg-step">1474</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1475"><div class="step-ref bg-step">1475</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1476"><div class="step-ref bg-step">1476</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="1476">15:40:46.799 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590246612,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763046613,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "c37a1452-56d1-4c40-8917-f117ae9f37ed",
          "taxHeadMasterCode": "PT_DECIMAL_CEILING_CREDIT",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590246996,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590246996
          },
          "tenantId": "pb.amritsar",
          "id": "aa451b16-5c91-4452-a792-784d037a69eb",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590246996,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590246996
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-407319",
      "id": "c37a1452-56d1-4c40-8917-f117ae9f37ed",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1477"><div class="step-ref bg-step">1477</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1478"><div class="step-ref bg-step">1478</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1479"><div class="step-ref bg-step">1479</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1480"><div class="step-ref bg-step">1480</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1481"><div class="step-ref bg-step">1481</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1482"><div class="step-ref bg-step">1482</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1483"><div class="step-ref bg-step">1483</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1484"><div class="step-ref bg-step">1484</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1485"><div class="step-ref bg-step">1485</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1486"><div class="step-ref bg-step">1486</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1487"><div class="step-ref bg-step">1487</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1488"><div class="step-ref bg-step">1488</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1489"><div class="step-ref bg-step">1489</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1490"><div class="step-ref bg-step">1490</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1491"><div class="step-ref bg-step">1491</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1492"><div class="step-ref bg-step">1492</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1493"><div class="step-ref bg-step">1493</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1494"><div class="step-ref bg-step">1494</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1495"><div class="step-ref bg-step">1495</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1496"><div class="step-ref bg-step">1496</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">190</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1496.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">182</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1497"><div class="step-ref bg-step">1497</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1498"><div class="step-ref bg-step">1498</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1499"><div class="step-ref bg-step">1499</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1500"><div class="step-ref bg-step">1500</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">5</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1501"><div class="step-ref bg-step">1501</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1502"><div class="step-ref bg-step">1502</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1503"><div class="step-ref bg-step">1503</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1504"><div class="step-ref bg-step">1504</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1505"><div class="step-ref bg-step">1505</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">9</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1506"><div class="step-ref bg-step">1506</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1507"><div class="step-ref bg-step">1507</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1508"><div class="step-ref bg-step">1508</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="1508">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1509"><div class="step-ref bg-step">1509</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1510"><div class="step-ref bg-step">1510</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1511"><div class="step-ref bg-step">1511</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1512"><div class="step-ref bg-step">1512</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">148</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1513"><div class="step-ref bg-step">1513</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1514"><div class="step-ref bg-step">1514</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1515"><div class="step-ref bg-step">1515</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1516"><div class="step-ref bg-step">1516</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1517"><div class="step-ref bg-step">1517</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1518"><div class="step-ref bg-step">1518</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1519"><div class="step-ref bg-step">1519</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1520"><div class="step-ref bg-step">1520</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1521"><div class="step-ref bg-step">1521</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1522"><div class="step-ref bg-step">1522</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1523"><div class="step-ref bg-step">1523</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1524"><div class="step-ref bg-step">1524</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1525"><div class="step-ref bg-step">1525</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1526"><div class="step-ref bg-step">1526</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1527"><div class="step-ref bg-step">1527</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[16:142]bg"><div class="step-container" id="1528"><div class="step-ref bg-step">1528</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">6</div></div><div class="step-row"><div class="step-container" id="1529"><div class="step-ref passed">1529</div><div class="step-cell passed">* def txnId = commonConstants.invalidParameters.passValusAsNull</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-cell comment"># calling search pg transaction pretest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1530"><div class="step-ref passed">1530</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceSearch.feature@searchPgTransactionSuccessfully')</div></div><div class="time-cell passed">684</div></div><div class="step-row"><div class="step-container" id="1530.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceSearch.feature</div></div><div class="time-cell passed">680</div></div><div class="step-row"><div class="step-container" id="1531"><div class="step-ref passed">1531</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1532"><div class="step-ref passed">1532</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionSuccessfully')</div></div><div class="time-cell passed">511</div></div><div class="step-row"><div class="step-container" id="1532.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell passed">507</div></div><div class="step-row"><div class="step-container" id="1533"><div class="step-ref passed">1533</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">3</div></div><div class="step-row"><div class="step-container" id="1534"><div class="step-ref passed">1534</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1535"><div class="step-ref passed">1535</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1536"><div class="step-ref passed">1536</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1537"><div class="step-ref passed">1537</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1538"><div class="step-ref passed">1538</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">499</div></div><div class="step-row"><div class="step-container" id="1539"><div class="step-ref passed">1539</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 200</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1540"><div class="step-ref passed">1540</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1541"><div class="step-ref passed">1541</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1542"><div class="step-ref passed">1542</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def txnId = pgServicesCreateResponseBody.Transaction.txnId</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1543"><div class="step-ref passed">1543</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesSearchPayload = read('../../core-services/requestPayload/pg-service/pgServicesSearch.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1544"><div class="step-ref passed">1544</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1545"><div class="step-ref passed">1545</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesSearchParam =</div></div><div class="time-cell passed">1</div></div><div class="preformatted" data-parent="1545">{
 txnId: '#(txnId)'
}</div><div class="step-row"><div class="step-container" id="1546"><div class="step-ref passed">1546</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServicesSearch</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1547"><div class="step-ref passed">1547</div><div class="step-indent"> </div><div class="step-cell passed">And params pgServicesSearchParam</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1548"><div class="step-ref passed">1548</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesSearchPayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1549"><div class="step-ref passed">1549</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">164</div></div><div class="step-row"><div class="step-container" id="1550"><div class="step-ref passed">1550</div><div class="step-indent"> </div><div class="step-cell passed">Then status 200</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1551"><div class="step-ref passed">1551</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesSearchResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1552"><div class="step-ref passed">1552</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesSearchResponseBody = response</div></div><div class="time-cell passed">0</div></div></div><div class="scenario"><div class="scenario-heading" id="[17:151]"><div class="heading-container"><div class="scenario-tags"><a class="badge badge-primary" href="karate-tags.html">negative</a><a class="badge badge-primary" href="karate-tags.html">regression</a><a class="badge badge-primary" href="karate-tags.html">PGSearch_MultipleTxn_03</a><a class="badge badge-primary" href="karate-tags.html">pgservices</a><a class="badge badge-primary" href="karate-tags.html">coreServices</a></div><span class="scenario-keyword">Scenario: [17:151]</span><span class="scenario-name">Verfiy searching transaction details using multiple txn id's </span></div><div class="scenario-time failed">ms: 2034</div></div><div class="step-row"><div class="step-container" id="[17:151]bg"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">Background:</div></div><div class="time-cell passed"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment"># calling create property and assess property</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1553"><div class="step-ref bg-step">1553</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">257</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1553.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">221</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1554"><div class="step-ref bg-step">1554</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="preformatted" data-parent="1554">15:40:47.779 karate.env:  
15:40:47.780 locale: en_IN 
15:40:47.781 tenantId: pb.amritsar</div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1555"><div class="step-ref bg-step">1555</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1556"><div class="step-ref bg-step">1556</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1557"><div class="step-ref bg-step">1557</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1558"><div class="step-ref bg-step">1558</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1559"><div class="step-ref bg-step">1559</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1560"><div class="step-ref bg-step">1560</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1561"><div class="step-ref bg-step">1561</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1562"><div class="step-ref bg-step">1562</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1563"><div class="step-ref bg-step">1563</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1564"><div class="step-ref bg-step">1564</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1565"><div class="step-ref bg-step">1565</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1566"><div class="step-ref bg-step">1566</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1567"><div class="step-ref bg-step">1567</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1568"><div class="step-ref bg-step">1568</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">185</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1568.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">177</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1569"><div class="step-ref bg-step">1569</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1570"><div class="step-ref bg-step">1570</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1571"><div class="step-ref bg-step">1571</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1572"><div class="step-ref bg-step">1572</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">11</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1573"><div class="step-ref bg-step">1573</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1574"><div class="step-ref bg-step">1574</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1575"><div class="step-ref bg-step">1575</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1576"><div class="step-ref bg-step">1576</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1577"><div class="step-ref bg-step">1577</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1578"><div class="step-ref bg-step">1578</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">144</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1579"><div class="step-ref bg-step">1579</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1580"><div class="step-ref bg-step">1580</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1581"><div class="step-ref bg-step">1581</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1582"><div class="step-ref bg-step">1582</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="1582">15:40:48.020 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590247833,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763047835,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "1a9cf038-bb2f-4387-9b1f-f1d9b7144933",
          "taxHeadMasterCode": "PT_ADVANCE_CARRYFORWARD",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590248218,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590248218
          },
          "tenantId": "pb.amritsar",
          "id": "947915fd-e0cf-4ce8-877f-b06a2af8d4d4",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590248218,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590248218
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-408409",
      "id": "1a9cf038-bb2f-4387-9b1f-f1d9b7144933",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1583"><div class="step-ref bg-step">1583</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1584"><div class="step-ref bg-step">1584</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1585"><div class="step-ref bg-step">1585</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1586"><div class="step-ref bg-step">1586</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1587"><div class="step-ref bg-step">1587</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1588"><div class="step-ref bg-step">1588</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1589"><div class="step-ref bg-step">1589</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1590"><div class="step-ref bg-step">1590</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1591"><div class="step-ref bg-step">1591</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1592"><div class="step-ref bg-step">1592</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1593"><div class="step-ref bg-step">1593</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1594"><div class="step-ref bg-step">1594</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">6</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1595"><div class="step-ref bg-step">1595</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1596"><div class="step-ref bg-step">1596</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1597"><div class="step-ref bg-step">1597</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1598"><div class="step-ref bg-step">1598</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1599"><div class="step-ref bg-step">1599</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1600"><div class="step-ref bg-step">1600</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1601"><div class="step-ref bg-step">1601</div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1602"><div class="step-ref bg-step">1602</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">215</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1602.1"><div class="step-ref bg-step">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">200</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1603"><div class="step-ref bg-step">1603</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1604"><div class="step-ref bg-step">1604</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1605"><div class="step-ref bg-step">1605</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1606"><div class="step-ref bg-step">1606</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1607"><div class="step-ref bg-step">1607</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1608"><div class="step-ref bg-step">1608</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1609"><div class="step-ref bg-step">1609</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1610"><div class="step-ref bg-step">1610</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1611"><div class="step-ref bg-step">1611</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1612"><div class="step-ref bg-step">1612</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">4</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1613"><div class="step-ref bg-step">1613</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1614"><div class="step-ref bg-step">1614</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="1614">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1615"><div class="step-ref bg-step">1615</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1616"><div class="step-ref bg-step">1616</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1617"><div class="step-ref bg-step">1617</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1618"><div class="step-ref bg-step">1618</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">173</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1619"><div class="step-ref bg-step">1619</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1620"><div class="step-ref bg-step">1620</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1621"><div class="step-ref bg-step">1621</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1622"><div class="step-ref bg-step">1622</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1623"><div class="step-ref bg-step">1623</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1624"><div class="step-ref bg-step">1624</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1625"><div class="step-ref bg-step">1625</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container"><div class="step-ref bg-step"></div><div class="step-cell comment">#initializing create pg transaction request payload objects</div></div><div class="time-cell comment"></div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1626"><div class="step-ref bg-step">1626</div><div class="step-cell passed">* def txnAmount = fetchBillResponse.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1627"><div class="step-ref bg-step">1627</div><div class="step-cell passed">* def name = 'User ' + randomString(10)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1628"><div class="step-ref bg-step">1628</div><div class="step-cell passed">* def mobileNumber = '78' + randomMobileNumGen(8)</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1629"><div class="step-ref bg-step">1629</div><div class="step-cell passed">* def pgSericesConstant = read('../../core-services/constants/pgServices.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1630"><div class="step-ref bg-step">1630</div><div class="step-cell passed">* def envCommon = read('file:envYaml/common/common.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1631"><div class="step-ref bg-step">1631</div><div class="step-cell passed">* def callbackUrl = envHost + envCommon.endPoints.pgServices.payload</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1632"><div class="step-ref bg-step">1632</div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">2</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1633"><div class="step-ref bg-step">1633</div><div class="step-cell passed">* def gateway = commonConstants.parameters.gateway</div></div><div class="time-cell passed">1</div></div><div class="step-row" data-parent="[17:151]bg"><div class="step-container" id="1634"><div class="step-ref bg-step">1634</div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row"><div class="step-container" id="1635"><div class="step-ref passed">1635</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionSuccessfully')</div></div><div class="time-cell passed">512</div></div><div class="step-row"><div class="step-container" id="1635.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell passed">508</div></div><div class="step-row"><div class="step-container" id="1636"><div class="step-ref passed">1636</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1637"><div class="step-ref passed">1637</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1638"><div class="step-ref passed">1638</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1639"><div class="step-ref passed">1639</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1640"><div class="step-ref passed">1640</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1641"><div class="step-ref passed">1641</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">501</div></div><div class="step-row"><div class="step-container" id="1642"><div class="step-ref passed">1642</div><div class="step-indent"> </div><div class="step-cell passed">Then status 200</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1643"><div class="step-ref passed">1643</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1644"><div class="step-ref passed">1644</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1645"><div class="step-ref passed">1645</div><div class="step-indent"> </div><div class="step-cell passed">And def txnId = pgServicesCreateResponseBody.Transaction.txnId</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1646"><div class="step-ref passed">1646</div><div class="step-cell passed">* def transactionIdFirst = txnId</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1647"><div class="step-ref passed">1647</div><div class="step-cell passed">* call read('../../business-services/tests/billingServicesDemand.feature@create_01')</div></div><div class="time-cell passed">283</div></div><div class="step-row"><div class="step-container" id="1647.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/tests/billingServicesDemand.feature</div></div><div class="time-cell passed">251</div></div><div class="step-row"><div class="step-container" id="1648"><div class="step-ref passed">1648</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1649"><div class="step-ref passed">1649</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row"><div class="step-container" id="1650"><div class="step-ref passed">1650</div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1651"><div class="step-ref passed">1651</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1652"><div class="step-ref passed">1652</div><div class="step-indent"> </div><div class="step-cell passed">* def consumerType = mdmsStateBillingService.BusinessService[0].businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1653"><div class="step-ref passed">1653</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = mdmsStateBillingService.BusinessService[0].code</div></div><div class="time-cell passed">3</div></div><div class="step-row"><div class="step-container" id="1654"><div class="step-ref passed">1654</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodFrom = getCurrentEpochTime()</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1655"><div class="step-ref passed">1655</div><div class="step-indent"> </div><div class="step-cell passed">* def daysFromToday = 2</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1656"><div class="step-ref passed">1656</div><div class="step-indent"> </div><div class="step-cell passed">* def taxPeriodTo = getEpochDate(daysFromToday)</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1657"><div class="step-ref passed">1657</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCodes = karate.jsonPath(mdmsStateBillingService, "$.TaxHeadMaster[?(@.service=='" + businessService + "')].code")</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1658"><div class="step-ref passed">1658</div><div class="step-indent"> </div><div class="step-cell passed">* def taxHeadMasterCode = taxHeadMasterCodes[randomNumber(taxHeadMasterCodes.length)]</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1659"><div class="step-ref passed">1659</div><div class="step-indent"> </div><div class="step-cell passed">* def taxAmount = 200</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1660"><div class="step-ref passed">1660</div><div class="step-indent"> </div><div class="step-cell passed">* def collectionAmount = 0</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1661"><div class="step-ref passed">1661</div><div class="step-indent"> </div><div class="step-cell passed">* def minimumAmountPayable = 1</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Steps to create a new Employee through HRMS</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1662"><div class="step-ref passed">1662</div><div class="step-indent"> </div><div class="step-cell passed">* call read('../../business-services/pretest/billingServiceDemandPretest.feature@createBillDemand')</div></div><div class="time-cell passed">216</div></div><div class="step-row"><div class="step-container" id="1662.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServiceDemandPretest.feature</div></div><div class="time-cell passed">206</div></div><div class="step-row"><div class="step-container" id="1663"><div class="step-ref passed">1663</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">3</div></div><div class="step-row"><div class="step-container" id="1664"><div class="step-ref passed">1664</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceDemandConstants = read('../../business-services/constants/billing-service-demand.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1665"><div class="step-ref passed">1665</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def commonConstants = read('../../common-services/constants/genericConstants.yaml')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1666"><div class="step-ref passed">1666</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def createDemandRequest = read('../../business-services/requestPayload/billing-service-demand/create.json')</div></div><div class="time-cell passed">9</div></div><div class="step-row"><div class="step-container" id="1667"><div class="step-ref passed">1667</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def searchDemandRequest = read('../../business-services/requestPayload/billing-service-demand/search.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1668"><div class="step-ref passed">1668</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def updateDemandRequest = read('../../business-services/requestPayload/billing-service-demand/update.json')</div></div><div class="time-cell passed">14</div></div><div class="step-row"><div class="step-container" id="1669"><div class="step-ref passed">1669</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">3</div></div><div class="step-row"><div class="step-container" id="1670"><div class="step-ref passed">1670</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url createDemandUrl</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell comment"># * print createDemandRequest</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1671"><div class="step-ref passed">1671</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request createDemandRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1672"><div class="step-ref passed">1672</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">165</div></div><div class="step-row"><div class="step-container" id="1673"><div class="step-ref passed">1673</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1674"><div class="step-ref passed">1674</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1675"><div class="step-ref passed">1675</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def billingServiceDemandResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1676"><div class="step-ref passed">1676</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* print billingServiceDemandResponseBody</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="1676">15:40:49.059 [print] {
  "ResponseInfo": {
    "ver": null,
    "resMsgId": null,
    "msgId": null,
    "apiId": null,
    "ts": null,
    "status": "201 CREATED"
  },
  "Demands": [
    {
      "taxPeriodFrom": 1628590248839,
      "businessService": "PT",
      "minimumAmountPayable": 1,
      "taxPeriodTo": 1628763048842,
      "fixedBillExpiryDate": null,
      "additionalDetails": null,
      "payer": null,
      "demandDetails": [
        {
          "demandId": "b4be3548-9b6d-4113-90b2-92c1310896a3",
          "taxHeadMasterCode": "PT_TIME_REBATE",
          "collectionAmount": 0,
          "auditDetails": {
            "lastModifiedTime": 1628590249258,
            "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
            "createdTime": 1628590249258
          },
          "tenantId": "pb.amritsar",
          "id": "211cd1e3-ac8f-4ef4-90e2-a9a998031208",
          "taxAmount": 200,
          "additionalDetails": null
        }
      ],
      "consumerType": "PropertyTax",
      "auditDetails": {
        "lastModifiedTime": 1628590249258,
        "createdBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "lastModifiedBy": "959745fe-66bc-45b2-9a35-609ec994abd4",
        "createdTime": 1628590249258
      },
      "tenantId": "pb.amritsar",
      "consumerCode": "Consumer-Code-Test-65696",
      "id": "b4be3548-9b6d-4113-90b2-92c1310896a3",
      "billExpiryTime": null,
      "isPaymentCompleted": false,
      "status": "ACTIVE"
    }
  ],
  "CollectedReceipt": null
}</div><div class="step-row"><div class="step-container" id="1677"><div class="step-ref passed">1677</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def Demands = billingServiceDemandResponseBody.Demands</div></div><div class="time-cell passed">5</div></div><div class="step-row"><div class="step-container" id="1678"><div class="step-ref passed">1678</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def demandId = Demands[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1679"><div class="step-ref passed">1679</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And def consumerCode = Demands[0].consumerCode</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the status Created</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1680"><div class="step-ref passed">1680</div><div class="step-indent"> </div><div class="step-cell passed">* assert billingServiceDemandResponseBody.ResponseInfo.status == commonConstants.expectedStatus.created</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand id is present</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1681"><div class="step-ref passed">1681</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].id == "#present"</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the tenantId of demand response is equal with current tenantId</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1682"><div class="step-ref passed">1682</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].tenantId == tenantId</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumer code of demand response is equal with defined consumerCode</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1683"><div class="step-ref passed">1683</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerCode == consumerCode</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the consumerType of demand response is equal with defined consumerType</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1684"><div class="step-ref passed">1684</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].consumerType == consumerType</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the businessService of demand response is equal with defined businessService</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1685"><div class="step-ref passed">1685</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].businessService == businessService</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodFrom of demand response is equal with defined taxPeriodFrom</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1686"><div class="step-ref passed">1686</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodFrom == taxPeriodFrom</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxPeriodTo of demand response is equal with defined taxPeriodTo</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1687"><div class="step-ref passed">1687</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].taxPeriodTo == taxPeriodTo</div></div><div class="time-cell passed">3</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand details id is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1688"><div class="step-ref passed">1688</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].id == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demandId is present in demand response body</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1689"><div class="step-ref passed">1689</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].demandId == "#present"</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxHeadMasterCode of demand response is equal with defined taxHeadMasterCode</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1690"><div class="step-ref passed">1690</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxHeadMasterCode == taxHeadMasterCode</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the taxAmount of demand response is equal with defined taxAmount</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1691"><div class="step-ref passed">1691</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].taxAmount == taxAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the collectionAmount of demand response is equal with defined collectionAmount</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1692"><div class="step-ref passed">1692</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].demandDetails[0].collectionAmount == collectionAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the minimumAmountPayable of demand response is equal with defined minimumAmountPayable</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1693"><div class="step-ref passed">1693</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].minimumAmountPayable == minimumAmountPayable</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># Validate the demand status is equal with expected demand status `ACTIVE`</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1694"><div class="step-ref passed">1694</div><div class="step-indent"> </div><div class="step-cell passed">* match billingServiceDemandResponseBody.Demands[0].status == billingServiceDemandConstants.parameters.status</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1695"><div class="step-ref passed">1695</div><div class="step-cell passed">* call read('../../business-services/pretest/billingServicePretest.feature@fetchBill')</div></div><div class="time-cell passed">208</div></div><div class="step-row"><div class="step-container" id="1695.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../business-services/pretest/billingServicePretest.feature</div></div><div class="time-cell passed">192</div></div><div class="step-row"><div class="step-container" id="1696"><div class="step-ref passed">1696</div><div class="step-indent"> </div><div class="step-cell passed">* def billingServiceConstants = read('../../business-services/constants/billing-service.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row"><div class="step-container" id="1697"><div class="step-ref passed">1697</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionServiceConstants = read('../../business-services/constants/apportionService.yaml')</div></div><div class="time-cell passed">3</div></div><div class="step-row"><div class="step-container" id="1698"><div class="step-ref passed">1698</div><div class="step-indent"> </div><div class="step-cell passed">* def businessService = billingServiceConstants.parameters.businessService</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1699"><div class="step-ref passed">1699</div><div class="step-indent"> </div><div class="step-cell passed">* def apportionbusinessService = apportionServiceConstants.parameters.businessService</div></div><div class="time-cell passed">9</div></div><div class="step-row"><div class="step-container" id="1700"><div class="step-ref passed">1700</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason1 = apportionServiceConstants.parameters.reason1</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1701"><div class="step-ref passed">1701</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason2 = apportionServiceConstants.parameters.reason2</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1702"><div class="step-ref passed">1702</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason3 = apportionServiceConstants.parameters.reason3</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1703"><div class="step-ref passed">1703</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillReason4 = apportionServiceConstants.parameters.reason4</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment">#* def consumerCode = 'Consumer-Code-Test-' + ranInteger(6)</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1704"><div class="step-ref passed">1704</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillRequest = read('../../business-services/requestPayload/collection-services/fetchBill.json')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1705"><div class="step-ref passed">1705</div><div class="step-indent"> </div><div class="step-cell passed">* def cancelBillRequest = read('../../business-services/requestPayload/collection-services/cancelBill.json')</div></div><div class="time-cell passed">7</div></div><div class="step-row"><div class="step-container" id="1706"><div class="step-ref passed">1706</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1707"><div class="step-ref passed">1707</div><div class="step-indent"> </div><div class="step-cell passed">* def fetchBillParams =</div></div><div class="time-cell passed">0</div></div><div class="preformatted" data-parent="1707">{
   consumerCode: '#(consumerCode)',
   businessService: '#(businessService)',
   tenantId: '#(tenantId)'
}</div><div class="step-row"><div class="step-container" id="1708"><div class="step-ref passed">1708</div><div class="step-indent"> </div><div class="step-cell passed">Given url fetchBill</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1709"><div class="step-ref passed">1709</div><div class="step-indent"> </div><div class="step-cell passed">And params fetchBillParams</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillParams</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1710"><div class="step-ref passed">1710</div><div class="step-indent"> </div><div class="step-cell passed">And request fetchBillRequest</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1711"><div class="step-ref passed">1711</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">158</div></div><div class="step-row"><div class="step-container"><div class="step-ref passed"></div><div class="step-indent"> </div><div class="step-cell comment"># * print fetchBillResponse</div></div><div class="time-cell comment"></div></div><div class="step-row"><div class="step-container" id="1712"><div class="step-ref passed">1712</div><div class="step-indent"> </div><div class="step-cell passed">Then status 201</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1713"><div class="step-ref passed">1713</div><div class="step-indent"> </div><div class="step-cell passed">And def fetchBillResponse = response</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1714"><div class="step-ref passed">1714</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmount = response.Bill[0].totalAmount</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1715"><div class="step-ref passed">1715</div><div class="step-indent"> </div><div class="step-cell passed">And def billId = response.Bill[0].id</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1716"><div class="step-ref passed">1716</div><div class="step-indent"> </div><div class="step-cell passed">And def txnAmount = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1717"><div class="step-ref passed">1717</div><div class="step-indent"> </div><div class="step-cell passed">And def totalAmountPaid = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1718"><div class="step-ref passed">1718</div><div class="step-indent"> </div><div class="step-cell passed">And def totalDue = totalAmount</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1719"><div class="step-ref passed">1719</div><div class="step-cell passed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionSuccessfully')</div></div><div class="time-cell passed">377</div></div><div class="step-row"><div class="step-container" id="1719.1"><div class="step-ref passed">&gt;&gt;</div><div class="step-cell passed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell passed">371</div></div><div class="step-row"><div class="step-container" id="1720"><div class="step-ref passed">1720</div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1721"><div class="step-ref passed">1721</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">13</div></div><div class="step-row"><div class="step-container" id="1722"><div class="step-ref passed">1722</div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">8</div></div><div class="step-row"><div class="step-container" id="1723"><div class="step-ref passed">1723</div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1724"><div class="step-ref passed">1724</div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1725"><div class="step-ref passed">1725</div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">346</div></div><div class="step-row"><div class="step-container" id="1726"><div class="step-ref passed">1726</div><div class="step-indent"> </div><div class="step-cell passed">Then status 200</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1727"><div class="step-ref passed">1727</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1728"><div class="step-ref passed">1728</div><div class="step-indent"> </div><div class="step-cell passed">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1729"><div class="step-ref passed">1729</div><div class="step-indent"> </div><div class="step-cell passed">And def txnId = pgServicesCreateResponseBody.Transaction.txnId</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1730"><div class="step-ref passed">1730</div><div class="step-cell passed">* def transactionIdSecond = txnId</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1731"><div class="step-ref passed">1731</div><div class="step-cell passed">* eval multipleTransactionIds = transactionIdFirst + ',' + transactionIdSecond</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1732"><div class="step-ref passed">1732</div><div class="step-cell passed">* eval txnId = multipleTransactionIds</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1733"><div class="step-ref failed">1733</div><div class="step-cell failed">* call read('../../core-services/pretests/pgServiceSearch.feature@searchPgTransactionSuccessfully')</div></div><div class="time-cell failed">152</div></div><div class="preformatted" data-parent="1733">15:40:49.819 feature call failed: classpath:com/egov/core-services/tests/../../core-services/pretests/pgServiceSearch.feature
arg: null
-unknown-:5 - 
pgServiceCreate.feature:13 - status code was: 400, expected: 200, response time: 135, url: https://qa.digit.org/pg-service/transaction/v1/_create?, response: {"ResponseInfo":null,"Errors":[{"code":"TXN_ABRUPTLY_DISCARDED","description":"","message":"A transaction for this bill has been abruptly discarded, please retry after 30 mins","params":null}]}
pgServices.feature:160 - 
-unknown-:5 - 
pgServiceCreate.feature:13 - status code was: 400, expected: 200, response time: 135, url: https://qa.digit.org/pg-service/transaction/v1/_create?, response: {"ResponseInfo":null,"Errors":[{"code":"TXN_ABRUPTLY_DISCARDED","description":"","message":"A transaction for this bill has been abruptly discarded, please retry after 30 mins","params":null}]}</div><div class="step-row"><div class="step-container" id="1733.1"><div class="step-ref failed">&gt;&gt;</div><div class="step-cell failed">com/egov/core-services/tests/../../core-services/pretests/pgServiceSearch.feature</div></div><div class="time-cell failed">147</div></div><div class="step-row"><div class="step-container" id="1734"><div class="step-ref passed">1734</div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">2</div></div><div class="step-row"><div class="step-container" id="1735"><div class="step-ref failed">1735</div><div class="step-indent"> </div><div class="step-cell failed">* call read('../../core-services/pretests/pgServiceCreate.feature@createPgTransactionSuccessfully')</div></div><div class="time-cell failed">145</div></div><div class="preformatted" data-parent="1735">15:40:49.819 feature call failed: classpath:com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature
arg: null
pgServiceCreate.feature:13 - status code was: 400, expected: 200, response time: 135, url: https://qa.digit.org/pg-service/transaction/v1/_create?, response: {"ResponseInfo":null,"Errors":[{"code":"TXN_ABRUPTLY_DISCARDED","description":"","message":"A transaction for this bill has been abruptly discarded, please retry after 30 mins","params":null}]}
-unknown-:5 - 
pgServiceCreate.feature:13 - status code was: 400, expected: 200, response time: 135, url: https://qa.digit.org/pg-service/transaction/v1/_create?, response: {"ResponseInfo":null,"Errors":[{"code":"TXN_ABRUPTLY_DISCARDED","description":"","message":"A transaction for this bill has been abruptly discarded, please retry after 30 mins","params":null}]}</div><div class="step-row"><div class="step-container" id="1735.1"><div class="step-ref failed">&gt;&gt;</div><div class="step-indent"> </div><div class="step-cell failed">com/egov/core-services/tests/../../core-services/pretests/pgServiceCreate.feature</div></div><div class="time-cell failed">141</div></div><div class="step-row"><div class="step-container" id="1736"><div class="step-ref passed">1736</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1737"><div class="step-ref passed">1737</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def jsUtils = read('classpath:com/egov/utils/jsUtils.js')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1738"><div class="step-ref passed">1738</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">* def pgServicesCreatePayload = read('../../core-services/requestPayload/pg-service/pgServicesCreate.json')</div></div><div class="time-cell passed">1</div></div><div class="step-row"><div class="step-container" id="1739"><div class="step-ref passed">1739</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">Given url pgServices</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1740"><div class="step-ref passed">1740</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">And request pgServicesCreatePayload</div></div><div class="time-cell passed">0</div></div><div class="step-row"><div class="step-container" id="1741"><div class="step-ref passed">1741</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell passed">When method post</div></div><div class="time-cell passed">137</div></div><div class="step-row"><div class="step-container" id="1742"><div class="step-ref failed">1742</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell failed">Then status 200</div></div><div class="time-cell failed">0</div></div><div class="preformatted" data-parent="1742">15:40:49.819 status code was: 400, expected: 200, response time: 135, url: https://qa.digit.org/pg-service/transaction/v1/_create?, response: {"ResponseInfo":null,"Errors":[{"code":"TXN_ABRUPTLY_DISCARDED","description":"","message":"A transaction for this bill has been abruptly discarded, please retry after 30 mins","params":null}]}
pgServiceCreate.feature:13 - status code was: 400, expected: 200, response time: 135, url: https://qa.digit.org/pg-service/transaction/v1/_create?, response: {"ResponseInfo":null,"Errors":[{"code":"TXN_ABRUPTLY_DISCARDED","description":"","message":"A transaction for this bill has been abruptly discarded, please retry after 30 mins","params":null}]}</div><div class="step-row"><div class="step-container" id="1743"><div class="step-ref skipped">1743</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell skipped">And def pgServicesCreateResponseHeader = responseHeaders</div></div><div class="time-cell skipped">0</div></div><div class="step-row"><div class="step-container" id="1744"><div class="step-ref skipped">1744</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell skipped">And def pgServicesCreateResponseBody = response</div></div><div class="time-cell skipped">0</div></div><div class="step-row"><div class="step-container" id="1745"><div class="step-ref skipped">1745</div><div class="step-indent"> </div><div class="step-indent"> </div><div class="step-cell skipped">And def txnId = pgServicesCreateResponseBody.Transaction.txnId</div></div><div class="time-cell skipped">0</div></div><div class="step-row"><div class="step-container" id="1746"><div class="step-ref skipped">1746</div><div class="step-indent"> </div><div class="step-cell skipped">* def pgServicesSearchPayload = read('../../core-services/requestPayload/pg-service/pgServicesSearch.json')</div></div><div class="time-cell skipped">0</div></div><div class="step-row"><div class="step-container" id="1747"><div class="step-ref skipped">1747</div><div class="step-indent"> </div><div class="step-cell skipped">* configure headers = read('classpath:com/egov/utils/websCommonHeaders.js')</div></div><div class="time-cell skipped">0</div></div><div class="step-row"><div class="step-container" id="1748"><div class="step-ref skipped">1748</div><div class="step-indent"> </div><div class="step-cell skipped">* def pgServicesSearchParam =</div></div><div class="time-cell skipped">0</div></div><div class="preformatted" data-parent="1748">{
 txnId: '#(txnId)'
}</div><div class="step-row"><div class="step-container" id="1749"><div class="step-ref skipped">1749</div><div class="step-indent"> </div><div class="step-cell skipped">Given url pgServicesSearch</div></div><div class="time-cell skipped">0</div></div><div class="step-row"><div class="step-container" id="1750"><div class="step-ref skipped">1750</div><div class="step-indent"> </div><div class="step-cell skipped">And params pgServicesSearchParam</div></div><div class="time-cell skipped">0</div></div><div class="step-row"><div class="step-container" id="1751"><div class="step-ref skipped">1751</div><div class="step-indent"> </div><div class="step-cell skipped">And request pgServicesSearchPayload</div></div><div class="time-cell skipped">0</div></div><div class="step-row"><div class="step-container" id="1752"><div class="step-ref skipped">1752</div><div class="step-indent"> </div><div class="step-cell skipped">When method post</div></div><div class="time-cell skipped">0</div></div><div class="step-row"><div class="step-container" id="1753"><div class="step-ref skipped">1753</div><div class="step-indent"> </div><div class="step-cell skipped">Then status 200</div></div><div class="time-cell skipped">0</div></div><div class="step-row"><div class="step-container" id="1754"><div class="step-ref skipped">1754</div><div class="step-indent"> </div><div class="step-cell skipped">And def pgServicesSearchResponseHeader = responseHeaders</div></div><div class="time-cell skipped">0</div></div><div class="step-row"><div class="step-container" id="1755"><div class="step-ref skipped">1755</div><div class="step-indent"> </div><div class="step-cell skipped">And def pgServicesSearchResponseBody = response</div></div><div class="time-cell skipped">0</div></div></div></div>
    </div>   
  </body>
</html>